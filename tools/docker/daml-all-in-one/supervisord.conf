[supervisord]
logfile_maxbytes = 50MB
logfile_backups=10
loglevel = info

[program:daml]
command = bash -c 'daml build && daml sandbox --wall-clock-time --dar ./.daml/dist/quickstart-0.0.1.dar || { echo "Command failed" >&2; exit 1; }'
autostart=true
autorestart=true
stderr_logfile=/var/log/daml.err.log
stdout_logfile=/var/log/daml.out.log
priority=10


[program:damlledger]
command = bash -c 'daml ledger upload-dar --host localhost --port 6865 .daml/dist/quickstart-0.0.1.dar && daml script --ledger-host localhost --ledger-port 6865 --dar .daml/dist/quickstart-0.0.1.dar --script-name Main:initialize --output-file output.json || { echo "Command failed" >&2; exit 1; }'
autostart=true
autorestart=true
stderr_logfile=/var/log/daml.err.log
stdout_logfile=/var/log/daml.out.log
priority=20

[program:jsonapi]
command = daml json-api --config json-api-app.conf
autostart=true
autorestart=true
stderr_logfile=/var/log/daml.err.log
stdout_logfile=/var/log/daml.out.log
priority=30

[inet_http_server]
port = 0.0.0.0:9001



