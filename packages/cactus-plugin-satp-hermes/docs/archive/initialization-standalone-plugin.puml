@startuml
title Hyperledger Cacti SATP-Hermes\nInitialization (standalone)

skinparam sequenceArrowThickness 2
skinparam roundcorner 20
skinparam maxmessagesize 120
skinparam sequenceParticipant underline
skinparam autonumber true

entity "SATPGateway" as g
entity "Orchestrator (GOL)" as gol
entity "Counterparty SATP Gateway" as cg
entity "WebServices" as web
entity "Dispatcher (BLO)" as dispatcher
entity "SATPManager" as manager
component "SATP Core" as core


g --> g: constructor(options)
g --> g: ProcessGatewayCoordinatorConfig()
g --> g: basic initialization (logger, signer, etc)

== GOL Init ==
g -> gol: initialize GatewayOrchestrator(GOLoptions)
group #Yellow if { get GOLoptions.CounterpartyGateways() }
    gol -> gol: basic initialization (logger, etc)
    gol -> gol: connectToCounterPartyGateways()
    gol -> gol: createChannel(counterpartyGateway)
    gol -> gol: createConnectClients(counterpartyGateway)
    gol -> cg: call healthcheck endpoint <color:red>(TBD ðŸš¨)    
else #Pink else only do basic initialization
end
gol --> g: GatewayOrchestrator

== BLO and SATP Manager Init ==
g --> bol: initialize BLODispatcher(options, GatewayOrchestrator)
bol --> bol: expose endpoints via getOrCreateWebServices()
bol --> manager: initialize SATPManager(options)
manager --> core: get SATP Service classes
core --> manager: services
manager --> manager: instantiate services (options)
manager --> core: get SATP Handler classes
core --> manager: handlers
manager --> manager: instatiate handlers (services, options)
manager --> bol: SATP manager

== Misc ==

g --> g: setup OpenAPI UI server


@enduml
