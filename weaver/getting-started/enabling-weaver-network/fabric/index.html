
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://hyperledger-cacti.github.io/cacti/weaver/getting-started/enabling-weaver-network/fabric/" rel="canonical"/>
<link href="../overview/" rel="prev"/>
<link href="../corda/" rel="next"/>
<link href="../../../../images/HL_Cacti_Logo_Colorreverse.svg" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.41" name="generator"/>
<title>Hyperledger Fabric - Using and Developing with Hyperledger Cacti</title>
<link href="../../../../assets/stylesheets/main.0253249f.min.css" rel="stylesheet"/>
<link href="../../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config",""),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#model">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<div data-md-color-scheme="default" data-md-component="outdated" hidden="">
<aside class="md-banner md-banner--warning">
<div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../../../..">
<strong>Click here to go to latest.</strong>
</a>
</div>
<script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
</aside>
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Using and Developing with Hyperledger Cacti" class="md-header__button md-logo" data-md-component="logo" href="../../../.." title="Using and Developing with Hyperledger Cacti">
<img alt="logo" src="../../../../images/HL_Cacti_Logo_Colorreverse.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Using and Developing with Hyperledger Cacti
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Hyperledger Fabric
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/hyperledger/cacti" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    hyperledger/cacti
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../..">
        
  
    
  
  Introduction

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../vision/">
        
  
    
  
  Vision

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../architecture/">
        
  
    
  
  Architecture

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../concepts/data-sharing/">
          
  
  Key Concepts

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../use-cases/">
        
  
    
  
  Use Cases

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../cactus/introduction/">
          
  
  Cactus

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../../introduction/">
          
  
  Weaver

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../guides/operations/">
          
  
  Guides

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../references/specs/">
          
  
  References

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../contributing/how-to-contribute/">
          
  
  Contributing

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../faqs/">
        
  
    
  
  FAQs

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../glossary/">
        
  
    
  
  Glossary

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../contact-us/">
        
  
    
  
  Contact Us

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../blog/2021-01-21-cross-chain-asset/">
          
  
  Blog

        </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Using and Developing with Hyperledger Cacti" class="md-nav__button md-logo" data-md-component="logo" href="../../../.." title="Using and Developing with Hyperledger Cacti">
<img alt="logo" src="../../../../images/HL_Cacti_Logo_Colorreverse.svg"/>
</a>
    Using and Developing with Hyperledger Cacti
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/hyperledger/cacti" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    hyperledger/cacti
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../..">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../vision/">
<span class="md-ellipsis">
    Vision
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../architecture/">
<span class="md-ellipsis">
    Architecture
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Key Concepts
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Key Concepts
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../concepts/data-sharing/">
<span class="md-ellipsis">
    Data Sharing
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../use-cases/">
<span class="md-ellipsis">
    Use Cases
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    Cactus
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Cactus
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/build/">
<span class="md-ellipsis">
    Building
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
<span class="md-ellipsis">
    Examples
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_3">
<span class="md-nav__icon md-icon"></span>
            Examples
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/examples/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/examples/supply-chain-app/">
<span class="md-ellipsis">
    Supply Chain Application
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/governance/">
<span class="md-ellipsis">
    Governance
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/code-of-conduct/">
<span class="md-ellipsis">
    Code of Conduct
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/contributing/">
<span class="md-ellipsis">
    Contributing
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/whitepaper/">
<span class="md-ellipsis">
    Whitepaper
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/regulatory-and-industry-initiatives-reading-list/">
<span class="md-ellipsis">
    Regulatory and Industry Initiatives
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_9" id="__nav_6_9_label" tabindex="0">
<span class="md-ellipsis">
    Components
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_9_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_9">
<span class="md-nav__icon md-icon"></span>
            Components
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/packages/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/packages/cactus-api-client/">
<span class="md-ellipsis">
    Api Client
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/packages/cactus-cmd-api-server/">
<span class="md-ellipsis">
    CMD Api Server
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/packages/cactus-common/">
<span class="md-ellipsis">
    Cactus Common
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/packages/cactus-core/">
<span class="md-ellipsis">
    Cactus Core
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/packages/cactus-plugin-consortium-manual/">
<span class="md-ellipsis">
    Consortium Manual
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/packages/cactus-plugin-keychain-vault/">
<span class="md-ellipsis">
    Keychain Vault
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/packages/cactus-plugin-ledger-connector-besu/">
<span class="md-ellipsis">
    Connector Besu
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/packages/cactus-plugin-ledger-connector-corda/">
<span class="md-ellipsis">
    Connector Corda
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/packages/cactus-plugin-ledger-connector-fabric/">
<span class="md-ellipsis">
    Connector Fabric
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/packages/cactus-test-api-client/">
<span class="md-ellipsis">
    Test Api Client
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/packages/cactus-test-cmd-api-server/">
<span class="md-ellipsis">
    Test CMD Api Server
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/packages/cactus-test-tooling/">
<span class="md-ellipsis">
    Test Tooling
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6_10" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_10" id="__nav_6_10_label" tabindex="0">
<span class="md-ellipsis">
    Ledger Browser
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_10_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_10">
<span class="md-nav__icon md-icon"></span>
            Ledger Browser
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/ledger-browser/overview/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/ledger-browser/setup/">
<span class="md-ellipsis">
    Setup
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6_10_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_10_3" id="__nav_6_10_3_label" tabindex="0">
<span class="md-ellipsis">
    Plugin Apps
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_10_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_10_3">
<span class="md-nav__icon md-icon"></span>
            Plugin Apps
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/ledger-browser/plugin-apps/app-patterns/">
<span class="md-ellipsis">
    App Patterns
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/ledger-browser/plugin-apps/ethereum-browser/">
<span class="md-ellipsis">
    Ethereum Browser
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/ledger-browser/plugin-apps/fabric-browser/">
<span class="md-ellipsis">
    Hyperledger Fabric Browser
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6_10_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_10_4" id="__nav_6_10_4_label" tabindex="0">
<span class="md-ellipsis">
    Developer Guide
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_10_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_10_4">
<span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/ledger-browser/developer-guide/overview/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/ledger-browser/developer-guide/architecture/">
<span class="md-ellipsis">
    Architecture
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/ledger-browser/developer-guide/tutorial/">
<span class="md-ellipsis">
    Tutorial
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6_11" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_11" id="__nav_6_11_label" tabindex="0">
<span class="md-ellipsis">
    Ledger Support
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_11_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_11">
<span class="md-nav__icon md-icon"></span>
            Ledger Support
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/support/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/support/besu/">
<span class="md-ellipsis">
    Hyperledger Besu
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/support/corda/">
<span class="md-ellipsis">
    R3 Corda
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/support/fabric/">
<span class="md-ellipsis">
    Hyperledger Fabric
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/support/iroha.md">
<span class="md-ellipsis">
    Hyperledger Iroha
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../cactus/support/xdai/">
<span class="md-ellipsis">
    xDai
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
<span class="md-ellipsis">
    Weaver
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            Weaver
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../introduction/">
<span class="md-ellipsis">
    Framework
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_7_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
<span class="md-ellipsis">
    Getting Started
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_7_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_2">
<span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../guide/">
<span class="md-ellipsis">
    Using Weaver
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_2_2" id="__nav_7_2_2_label" tabindex="0">
<span class="md-ellipsis">
    Launching a Test Network
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_2_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_7_2_2">
<span class="md-nav__icon md-icon"></span>
            Launching a Test Network
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../test-network/overview/">
<span class="md-ellipsis">
    Component Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../test-network/setup-local/">
<span class="md-ellipsis">
    Setup with Locally Built Weaver Components
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../test-network/setup-local-docker/">
<span class="md-ellipsis">
    Setup with Locally Built Dockerized Weaver Components
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../test-network/setup-packages/">
<span class="md-ellipsis">
    Setup with Imported Weaver Components
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../test-network/setup-packages-docker/">
<span class="md-ellipsis">
    Setup with Imported Dockerized Weaver Components
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../test-network/ledger-initialization/">
<span class="md-ellipsis">
    Ledger Initialization
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../test-network/advanced-configuration/">
<span class="md-ellipsis">
    Advanced Configuration
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_2_3" id="__nav_7_2_3_label" tabindex="0">
<span class="md-ellipsis">
    Testing Interoperation Modes
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_2_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_7_2_3">
<span class="md-nav__icon md-icon"></span>
            Testing Interoperation Modes
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../interop/overview/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../interop/data-sharing/">
<span class="md-ellipsis">
    Data Sharing
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7_2_3_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_2_3_3" id="__nav_7_2_3_3_label" tabindex="0">
<span class="md-ellipsis">
    Asset Exchange
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_2_3_3_label" class="md-nav" data-md-level="4">
<label class="md-nav__title" for="__nav_7_2_3_3">
<span class="md-nav__icon md-icon"></span>
            Asset Exchange
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../interop/asset-exchange/overview/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../interop/asset-exchange/fabric-fabric/">
<span class="md-ellipsis">
    Fabric with Fabric
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../interop/asset-exchange/fabric-corda/">
<span class="md-ellipsis">
    Fabric with Corda
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../interop/asset-exchange/fabric-besu/">
<span class="md-ellipsis">
    Fabric with Besu
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../interop/asset-exchange/corda-corda/">
<span class="md-ellipsis">
    Corda with Corda
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../interop/asset-exchange/corda-besu/">
<span class="md-ellipsis">
    Corda with Besu
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../interop/asset-exchange/besu-besu/">
<span class="md-ellipsis">
    Besu with Besu
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../interop/asset-transfer/">
<span class="md-ellipsis">
    Asset Transfer
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_7_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_2_4" id="__nav_7_2_4_label" tabindex="0">
<span class="md-ellipsis">
    Enabling Weaver in your Network and Application
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_7_2_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_7_2_4">
<span class="md-nav__icon md-icon"></span>
            Enabling Weaver in your Network and Application
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../overview/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Hyperledger Fabric
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Hyperledger Fabric
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#model">
<span class="md-ellipsis">
      Model
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#procedural-overview">
<span class="md-ellipsis">
      Procedural Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#development-phase">
<span class="md-ellipsis">
      Development Phase
    </span>
</a>
<nav aria-label="Development Phase" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#chaincode">
<span class="md-ellipsis">
      Chaincode
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#client-or-layer-2-applications">
<span class="md-ellipsis">
      Client (or Layer-2) Applications
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#pre-configuration-phase">
<span class="md-ellipsis">
      Pre-Configuration Phase
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#startup-and-bootstrap-phase">
<span class="md-ellipsis">
      Startup and Bootstrap Phase
    </span>
</a>
<nav aria-label="Startup and Bootstrap Phase" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#for-asset-exchange_2">
<span class="md-ellipsis">
      For Asset Exchange
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#for-data-sharing-or-asset-transfer">
<span class="md-ellipsis">
      For Data Sharing or Asset Transfer
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../corda/">
<span class="md-ellipsis">
    R3 Corda
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../besu/">
<span class="md-ellipsis">
    Hyperledger Besu
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
<span class="md-ellipsis">
    What is Interoperability?
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_3">
<span class="md-nav__icon md-icon"></span>
            What is Interoperability?
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../what-is-interoperability/understanding-interoperability/">
<span class="md-ellipsis">
    Understanding Interoperability
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../what-is-interoperability/levels-of-interoperability/">
<span class="md-ellipsis">
    Levels of Interoperability
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../what-is-interoperability/integration-patterns/">
<span class="md-ellipsis">
    Integration Patterns
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../interoperability-modes/">
<span class="md-ellipsis">
    Interoperability Modes
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../design-principles/">
<span class="md-ellipsis">
    Design Principles
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
<span class="md-ellipsis">
    User Stories
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_6">
<span class="md-nav__icon md-icon"></span>
            User Stories
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../user-stories/overview/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../user-stories/global-trade/">
<span class="md-ellipsis">
    Global Trade
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../user-stories/financial-markets/">
<span class="md-ellipsis">
    DvP in Financial Markets
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../user-stories/legacy-integration/">
<span class="md-ellipsis">
    Legacy Integration
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
<span class="md-ellipsis">
    Architecture and Design
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_7">
<span class="md-nav__icon md-icon"></span>
            Architecture and Design
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../architecture-and-design/overview/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../architecture-and-design/relay/">
<span class="md-ellipsis">
    Relay
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../architecture-and-design/drivers/">
<span class="md-ellipsis">
    Drivers
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../architecture-and-design/weaver-dapps/">
<span class="md-ellipsis">
    Weaver DApps
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../architecture-and-design/decentralized-identity/">
<span class="md-ellipsis">
    Decentralized Identity
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_8" id="__nav_7_8_label" tabindex="0">
<span class="md-ellipsis">
    Security Model
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_8_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_8">
<span class="md-nav__icon md-icon"></span>
            Security Model
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../security-model/authentication/">
<span class="md-ellipsis">
    Authentication
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../security-model/access-control/">
<span class="md-ellipsis">
    Access Control
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../security-model/proofs-and-verification/">
<span class="md-ellipsis">
    Proofs and Verification
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../security-model/end-to-end-security/">
<span class="md-ellipsis">
    End-to-End Security
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_9" id="__nav_7_9_label" tabindex="0">
<span class="md-ellipsis">
    Deployment Considerations
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_9_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_9">
<span class="md-nav__icon md-icon"></span>
            Deployment Considerations
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../deployment-considerations/deployment-patterns/">
<span class="md-ellipsis">
    Deployment Patterns
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../deployment-considerations/governance-and-policies/">
<span class="md-ellipsis">
    Governance and Policies
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../deployment-considerations/legal-and-regulation/">
<span class="md-ellipsis">
    Legal and Regulation
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../specifications/">
<span class="md-ellipsis">
    Specifications
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../roadmap/">
<span class="md-ellipsis">
    Roadmap
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../publications/">
<span class="md-ellipsis">
    Publications
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
<span class="md-ellipsis">
    Guides
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            Guides
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../guides/operations/">
<span class="md-ellipsis">
    Operations
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../guides/developers/">
<span class="md-ellipsis">
    Developers
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../guides/upgrading/">
<span class="md-ellipsis">
    Upgrading
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
<span class="md-ellipsis">
    References
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_9_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_9">
<span class="md-nav__icon md-icon"></span>
            References
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../references/specs/">
<span class="md-ellipsis">
    Technical Specifications
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../references/publications/">
<span class="md-ellipsis">
    Publications
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../references/events/">
<span class="md-ellipsis">
    Events and Podcasts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../references/business/">
<span class="md-ellipsis">
    Business Usage
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../references/best-practices/">
<span class="md-ellipsis">
    Project Best Practices
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../references/github/">
<span class="md-ellipsis">
    GitHub Contributions
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../references/openapi/">
<span class="md-ellipsis">
    OpenAPI Specs
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_10" type="checkbox"/>
<label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
<span class="md-ellipsis">
    Contributing
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_10_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_10">
<span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../contributing/how-to-contribute/">
<span class="md-ellipsis">
    How to Contribute
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../contributing/reporting-a-bug/">
<span class="md-ellipsis">
    Reporting a Bug
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../contributing/requesting-a-change/">
<span class="md-ellipsis">
    Requesting a Change
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../contributing/asking-a-question/">
<span class="md-ellipsis">
    Asking a Question
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../faqs/">
<span class="md-ellipsis">
    FAQs
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../glossary/">
<span class="md-ellipsis">
    Glossary
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../contact-us/">
<span class="md-ellipsis">
    Contact Us
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_14" type="checkbox"/>
<label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex="0">
<span class="md-ellipsis">
    Blog
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_14_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_14">
<span class="md-nav__icon md-icon"></span>
            Blog
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_14_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_14_1" id="__nav_14_1_label" tabindex="0">
<span class="md-ellipsis">
    January 21, 2021
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_14_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_14_1">
<span class="md-nav__icon md-icon"></span>
            January 21, 2021
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../blog/2021-01-21-cross-chain-asset/">
<span class="md-ellipsis">
    Enabling Cross-Chain Asset Exchange On Permissioned Blockchains
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../blog/2021-01-21-emergence-enterprise-interoperability/">
<span class="md-ellipsis">
    Emergence of Enterprise DLT Interoperability
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_14_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_14_2" id="__nav_14_2_label" tabindex="0">
<span class="md-ellipsis">
    November 07, 2022
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_14_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_14_2">
<span class="md-nav__icon md-icon"></span>
            November 07, 2022
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../blog/2022-11-07-introducing-hyperledger-cacti/">
<span class="md-ellipsis">
    Introducing Hyperledger Cacti, a multi-faceted pluggable interoperability framework
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_14_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_14_3" id="__nav_14_3_label" tabindex="0">
<span class="md-ellipsis">
    October 03, 2023
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_14_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_14_3">
<span class="md-nav__icon md-icon"></span>
            October 03, 2023
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../blog/2023-10-03-hyperledger-cacti-graduation/">
<span class="md-ellipsis">
    Hyperledger Cacti, A General-Purpose Modular Interoperability Framework, Moves to Graduated Status
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1>Hyperledger Fabric</h1>
<!--
 Copyright IBM Corp. All Rights Reserved.

 SPDX-License-Identifier: CC-BY-4.0
 -->
<p>After testing the Weaver interoperation mechanisms on <a href="../../test-network/overview/">basic sample networks</a>, you may be interested in finding out how you can equip an existing real network, whether in development or in production, to exercise these mechanisms. In this document, we will demonstrate how to equip a Fabric network and application with Weaver components and capabilities.</p>
<h2 id="model">Model<a class="headerlink" href="#model" title="Permanent link">¶</a></h2>
<p>The figure below illustrates a typical Fabric network. The infrastructure consists of a set of peers, ordering service nodes, and CAs that perform the roles of MSPs; each serves a given <em>organization</em> which is one of the constituent units of the network. On the peers are installed one or more smart contracts (<em>chaincode</em>), representing shared business logic across the different organizations. Further up lie the so-called Layer-2 (or client) applications that consist of organization-specific business logic and invoke the smart contracts using APIs exposed by the Fabric SDK and with wallet credentials issued by their respective organizations' CAs.</p>
<p><img alt="alt text" src="../../../../images-weaver-docs/enabling-weaver/fabric-network-model.png"/></p>
<p>Such a network equipped with Weaver components and capabilities will look like the figure below. Legacy components are marked in grey and Weaver and bridging components in green.</p>
<p><img alt="alt text" src="../../../../images-weaver-docs/enabling-weaver/fabric-weaver-model.png"/></p>
<p>The relay and driver are the only additional infrastructure that need to be installed. One or more relays can be installed, as can one or more drivers. The drivers are illustrated in Layer-2 rather than in the bottom layer because, though they are coupled with relays, they exercise contracts using the Fabric SDK and organization-issued credentials just like any Layer-2 application does.</p>
<p>Existing chaincode deployed on the network's channels remain undisturbed. All that is required in the smart contracts layer is the deployment of the Fabric Interoperation Chaincode on every channel that needs to offer or consume state from foreign networks.</p>
<p>Layer-2, or client, applications will need some additional code and configuration because the decisions to exercise interoperation mechanisms (relay queries for data sharing or atomic asset exchanges) are strictly part of business logic. But Weaver's Fabric Interoperation Node SDK offers various helper functions to ease this process and keep the adaptation to a minimum, as we wil see later in this document. Finally, an <em>identity service</em> must be offered by the network to expose its CAs' certificate chains to foreign networks, thereby laying the basis for interoperation. This service simply needs to offer a REST endpoint, and can be implemented as a standalone application or (more conveniently) as an augmentation of one or more of the existing Layer-2 applications.</p>
<h2 id="procedural-overview">Procedural Overview<a class="headerlink" href="#procedural-overview" title="Permanent link">¶</a></h2>
<p>A Hyperledger Fabric network is typically created in phases, in the following sequence:</p>
<ol>
<li><strong>Development</strong>: This involves writing chaincode and Layer-2 applications. The chaincode's deployment name/ID and its transaction API must be designed first, but subsequent development of the two layers of applications can then proceed parallelly.</li>
<li><strong>Pre-Configuration</strong>: This involves creating a desired specification (as a set of configuration diles) of the network topology and the ledgers it maintains.</li>
<li><strong>Startup and Bootstrap</strong>: This is the launch phase, in which the network components and applications are started and bootstrapped (i.e., configured with initial state and operating rules).</li>
</ol>
<p>Assuming that the reader is familiar with this procedure, we will walk through the changes required in each phase to make your network ready for interoperation using Weaver components and code templates. This will involve code addition and adaptation, deployment of additional modules, additional configuration, and creation of additional ledger state records. The requirements and effort will vary with the mode of interoperation you wish to support in your Fabric network.</p>
<h2 id="development-phase">Development Phase<a class="headerlink" href="#development-phase" title="Permanent link">¶</a></h2>
<p>A Fabric distributed application's business logic code spans two layers as illustrated in the network model.</p>
<h3 id="chaincode">Chaincode<a class="headerlink" href="#chaincode" title="Permanent link">¶</a></h3>
<p>These are smart contracts embodied in code, managing business workflow state and digital assets.</p>
<h4 id="for-data-sharing">For Data Sharing<a class="headerlink" href="#for-data-sharing" title="Permanent link">¶</a></h4>
<p>No code changes are required for Weaver enablement, because data sharing involves:</p>
<ul>
<li>View packaging (and optionally, encryption) logic and access control logic in a source network, and</li>
<li>View validation logic in a destination network</li>
</ul>
<p>This logic is standard and independent of smart contract, asset, and state, particulars. It is already implemented in the Fabric Interoperation Chaincode offered by Weaver. Hence you just need to deploy that chaincode to exercise data sharing from, or to, your application chaincode. Your application chaincode can be oblivious of the Fabric Interoperation Chaincode's workings and of the view request-response protocol.</p>
<h4 id="for-asset-exchange">For Asset Exchange<a class="headerlink" href="#for-asset-exchange" title="Permanent link">¶</a></h4>
<p>To exchange an asset using Weaver, the asset's state on the ledger must be controlled in the following ways:</p>
<ul>
<li>Locked in favor of a party</li>
<li>Claimed by the party to whom the asset is pledged</li>
<li>Returned to the original owner if it is not claimed within a given timeframe</li>
</ul>
<p>In addition, the state of the asset (i.e., whether it is locked), and its current and targeted owners, must be determinable by looking at the ledger records.</p>
<p>The bookkeeping logic required to maintain records of locks can be abstracted away from the particulars of a digital asset and its workflow. But as such assets and their properties (including ownership) can be, and are, encoded in an arbitrary number of ways, we cannot provide a one-size-fits all set of functions (like in the data sharing protocol) to exchange any kind of asset. Instead, we must rely on the application contract (chaincode) managing an asset, as it knows precisely what the asset's properties are and how they can be updated and queried on the ledger (channel).</p>
<p>What Weaver offers, therefore, is the following:</p>
<ul>
<li>Lock management (bookkeeping) logic implemented in the Fabric Interoperation Chaincode that treats each asset as an abstract object and is agnostic of the assets' internals. This logic can be exercised in one of two ways:<ul>
<li>Importing the <a href="https://pkg.go.dev/github.com/hyperledger/cacti/weaver/core/network/fabric-interop-cc/libs/assetexchange/v2"><code>assetexchange</code></a> library from the Fabric Interoperation Chaincode into your application chaincode, or</li>
<li>Invoking them within the Fabric Interoperation Chaincode using a <a href="https://pkg.go.dev/github.com/hyperledger/fabric-chaincode-go/shim#ChaincodeStub.InvokeChaincode">chaincode-to-chaincode call</a>.</li>
</ul>
</li>
<li>A set of template functions with sample (and extensible) code that must be added to the application chaincode to exercise the above lock management functions.</li>
</ul>
<p>Below, we list the template functions with sample code that you, as a developer, must use and adapt within your chaincode, in either mode (library import or chaincode invocations).</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">The instructions here apply only to chaincode implemented in Go, because Weaver presently offers only a Go version of the Fabric Interoperation Chaincode.</td>
</tr>
</tbody>
</table>
<ul>
<li><em>Using the <a href="https://pkg.go.dev/github.com/hyperledger/cacti/weaver/core/network/fabric-interop-cc/libs/assetexchange/v2"><code>assetexchange</code></a> Library</em>: This method doesn't require the <a href="https://pkg.go.dev/github.com/hyperledger/cacti/weaver/core/network/fabric-interop-cc/contracts/interop/v2"><code>Fabric Interoperation Chaincode</code></a> to be installed. In your smart contract's <code>go.mod</code>, add the following in the <code>require</code> section (the sample below uses the current versions for dependency packages; update them to the latest versions offered by Cacti):
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nx">require</span><span class="p">(</span>
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">hyperledger</span><span class="o">/</span><span class="nx">cacti</span><span class="o">/</span><span class="nx">weaver</span><span class="o">/</span><span class="nx">common</span><span class="o">/</span><span class="nx">protos</span><span class="o">-</span><span class="k">go</span><span class="o">/</span><span class="nx">v2</span><span class="w"> </span><span class="nx">v2</span><span class="mf">.0.0</span>
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">    </span><span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">hyperledger</span><span class="o">/</span><span class="nx">cacti</span><span class="o">/</span><span class="nx">weaver</span><span class="o">/</span><span class="nx">core</span><span class="o">/</span><span class="nx">network</span><span class="o">/</span><span class="nx">fabric</span><span class="o">-</span><span class="nx">interop</span><span class="o">-</span><span class="nx">cc</span><span class="o">/</span><span class="nx">libs</span><span class="o">/</span><span class="nx">assetexchange</span><span class="o">/</span><span class="nx">v2</span><span class="w"> </span><span class="nx">v2</span><span class="mf">.0.0</span>
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="p">)</span>
</code></pre></div>
  The following functions need to be added to your chaincode, and the smart contract class/type used below is called <code>SmartContract</code> (<em>Note</em>: the function signature, i.e. the name, arguments, and return values, need to be exactly what is given in the below samples; you can have additional code to manage asset state as per need):<ol>
<li><strong>LockAsset</strong>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">    </span><span class="s">"github.com/hyperledger/cacti/weaver/core/network/fabric-interop-cc/libs/assetexchange/v2"</span>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="p">)</span>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">LockAsset</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">assetExchangeAgreementSerializedProto64</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">lockInfoSerializedProto64</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">    </span><span class="c1">// Add some safety checks before calling LockAsset from library</span>
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">    </span><span class="c1">// Caller of this chaincode is supposed to be the Locker and the owner of the asset being locked.</span>
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">    </span><span class="nx">contractId</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">assetexchange</span><span class="p">.</span><span class="nx">LockAsset</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="s">""</span><span class="p">,</span><span class="w"> </span><span class="nx">assetExchangeAgreementSerializedProto64</span><span class="p">,</span><span class="w"> </span><span class="nx">lockInfoSerializedProto64</span><span class="p">)</span>
<a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">""</span><span class="p">,</span><span class="w"> </span><span class="nx">logThenErrorf</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">Error</span><span class="p">())</span>
<a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="w">    </span><span class="c1">// Post proccessing of asset after LockAsset called like change status of the asset so that it can't be spent.</span>
<a href="#__codelineno-1-13" id="__codelineno-1-13" name="__codelineno-1-13"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-1-14" id="__codelineno-1-14" name="__codelineno-1-14"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">contractId</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<a href="#__codelineno-1-15" id="__codelineno-1-15" name="__codelineno-1-15"></a><span class="p">}</span>
</code></pre></div>
   Here <code>assetExchangeAgreementSerializedProto64</code> is a serialized protobuf in Base64 encoded string of <code>AssetExchangeAgreement</code> protobuf structure, and can be used to extract details like asset id, type of asset and recipient. Check the structure definition <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/rfcs/formats/assets/exchange.md#representing-two-party-asset-exchange-agreements">here</a>.
   Similarly <code>lockInfoSerializedProto64</code> is a serialized protobuf in Base64 encoded string of <code>AssetLock</code> protobuf structure. Check the structure definition <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/rfcs/formats/assets/exchange.md#representing-locks-on-assets">here</a>.</li>
<li><strong>LockFungibleAsset</strong>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">LockFungibleAsset</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">fungibleAssetExchangeAgreementSerializedProto64</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">lockInfoSerializedProto64</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="w">    </span><span class="c1">// Add some safety checks before calling LockFungibleAsset from library</span>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">    </span><span class="c1">// Caller of this chaincode is supposed to be the Locker and the owner of the asset being locked.</span>
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">    </span><span class="nx">contractId</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">assetexchange</span><span class="p">.</span><span class="nx">LockFungibleAsset</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="s">""</span><span class="p">,</span><span class="w"> </span><span class="nx">fungibleAssetExchangeAgreementSerializedProto64</span><span class="p">,</span><span class="w"> </span><span class="nx">lockInfoSerializedProto64</span><span class="p">)</span>
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">""</span><span class="p">,</span><span class="w"> </span><span class="nx">logThenErrorf</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">Error</span><span class="p">())</span>
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="w">    </span><span class="c1">// Post proccessing of asset after LockFungibleAsset called like reduce the amount of tokens owned by the locker, or mark it locked so that it can't be spent.</span>
<a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">contractId</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="p">}</span>
</code></pre></div>
   Here <code>fungibleAssetExchangeAgreementSerializedProto64</code> is a serialized protobuf in Base64 encoded string of <code>FungibleAssetExchangeAgreement</code> protobuf structure, and can be used to extract details like asset quantity, type of asset and recipient. Check the structure definition <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/rfcs/formats/assets/exchange.md#representing-two-party-asset-exchange-agreements">here</a>.</li>
<li><strong>IsAssetLockedQueryUsingContractId</strong>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">IsAssetLockedQueryUsingContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">assetexchange</span><span class="p">.</span><span class="nx">IsAssetLockedQueryUsingContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="p">)</span>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="p">}</span>
</code></pre></div></li>
<li><strong>ClaimAssetUsingContractId</strong>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">ClaimAssetUsingContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="p">,</span><span class="w"> </span><span class="nx">claimInfoSerializedProto64</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">    </span><span class="c1">// Note recipient will be the caller for this function</span>
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">    </span><span class="nx">claimed</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kc">false</span>
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">    </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">assetexchange</span><span class="p">.</span><span class="nx">ClaimAssetUsingContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="p">,</span><span class="w"> </span><span class="nx">claimInfoSerializedProto64</span><span class="p">)</span>
<a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="nx">logThenErrorf</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">Error</span><span class="p">())</span>
<a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="w">    </span><span class="nx">claimed</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="w">    </span><span class="c1">// After the above function call, update the owner of the asset with recipeint/caller</span>
<a href="#__codelineno-4-10" id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-4-11" id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">claimed</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<a href="#__codelineno-4-12" id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="p">}</span>
</code></pre></div></li>
<li><strong>UnlockAssetUsingContractId</strong>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">UnlockAssetUsingContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">    </span><span class="nx">unlocked</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kc">false</span>
<a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">    </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">assetexchange</span><span class="p">.</span><span class="nx">UnlockAssetUsingContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="p">)</span>
<a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="nx">logThenErrorf</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">Error</span><span class="p">())</span>
<a href="#__codelineno-5-6" id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-5-7" id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="w">    </span><span class="nx">unlocked</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-5-8" id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-5-9" id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<a href="#__codelineno-5-10" id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="p">}</span>
</code></pre></div></li>
</ol>
</li>
</ul>
<p>In addition, you should add the following extra utility functions to enable client applications to query and discover asset state:
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">GetHTLCHashByContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">assetexchange</span><span class="p">.</span><span class="nx">GetHTLCHashByContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="p">)</span>
<a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="p">}</span>
<a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">GetHTLCHashPreImageByContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">assetexchange</span><span class="p">.</span><span class="nx">GetHTLCHashPreImageByContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="p">)</span>
<a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="p">}</span>
</code></pre></div></p>
<p>There is an alternative API to implement asset exchange using this library, which doesn't involve contract IDs. For details, see the <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/core/network/fabric-interop-cc/libs/assetexchange/README.md#without-contractid">Asset Exchange Library README</a>.</p>
<ul>
<li><em>Using the <a href="https://pkg.go.dev/github.com/hyperledger/cacti/weaver/core/network/fabric-interop-cc/contracts/interop/v2"><code>Fabric Interoperation Chaincode</code></a></em>: This method requires the Fabric Interoperation Chaincode to be installed on all peers of the channel, using a special chaincode ID (e.g., <code>interop</code>, which is what we will use later in this document). Your application chaincode needs to implement the interface <code>github.com/hyperledger/cacti/weaver/core/network/fabric-interop-cc/interfaces/asset-mgmt/v2</code>.
  In your smart contract's <code>go.mod</code>, add the following in the <code>require</code> section (update the version to the latest Cacti version):
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="nx">require</span><span class="p">(</span>
<a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">    </span><span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">hyperledger</span><span class="o">/</span><span class="nx">cacti</span><span class="o">/</span><span class="nx">weaver</span><span class="o">/</span><span class="nx">common</span><span class="o">/</span><span class="nx">protos</span><span class="o">-</span><span class="k">go</span><span class="o">/</span><span class="nx">v2</span><span class="w"> </span><span class="nx">v2</span><span class="mf">.0.0</span>
<a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">    </span><span class="nx">github</span><span class="p">.</span><span class="nx">com</span><span class="o">/</span><span class="nx">hyperledger</span><span class="o">/</span><span class="nx">cacti</span><span class="o">/</span><span class="nx">weaver</span><span class="o">/</span><span class="nx">core</span><span class="o">/</span><span class="nx">network</span><span class="o">/</span><span class="nx">fabric</span><span class="o">-</span><span class="nx">interop</span><span class="o">-</span><span class="nx">cc</span><span class="o">/</span><span class="nx">interfaces</span><span class="o">/</span><span class="nx">asset</span><span class="o">-</span><span class="nx">mgmt</span><span class="o">/</span><span class="nx">v2</span><span class="w"> </span><span class="nx">v2</span><span class="mf">.0.0</span>
<a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="p">)</span>
</code></pre></div>
  In the SmartContract class definition file, add the following code:
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="w">    </span><span class="nx">am</span><span class="w"> </span><span class="s">"github.com/hyperledger/cacti/weaver/core/network/fabric-interop-cc/interfaces/asset-mgmt/v2"</span>
<a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="p">)</span>
<a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="kd">type</span><span class="w"> </span><span class="nx">SmartContract</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a><span class="w">    </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">Contract</span>
<a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="w">    </span><span class="nx">amc</span><span class="w"> </span><span class="nx">am</span><span class="p">.</span><span class="nx">AssetManagementContract</span>
<a href="#__codelineno-8-8" id="__codelineno-8-8" name="__codelineno-8-8"></a><span class="p">}</span>
</code></pre></div>
  The following functions need to be added to your chaincode (<em>Note</em>: the function signature, i.e. the name, arguments, and return values, need to be exactly what is given in the below samples; you can have additional code to manage asset state as per need):<ol>
<li><strong>LockAsset</strong>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">LockAsset</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">assetExchangeAgreementSerializedProto64</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">lockInfoSerializedProto64</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="w">    </span><span class="c1">// Add some safety checks before calling LockAsset from library</span>
<a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="w">    </span><span class="c1">// Caller of this chaincode is supposed to be the Locker and the owner of the asset being locked.</span>
<a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="w">    </span><span class="nx">contractId</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">amc</span><span class="p">.</span><span class="nx">LockAsset</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="s">""</span><span class="p">,</span><span class="w"> </span><span class="nx">assetExchangeAgreementSerializedProto64</span><span class="p">,</span><span class="w"> </span><span class="nx">lockInfoSerializedProto64</span><span class="p">)</span>
<a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">""</span><span class="p">,</span><span class="w"> </span><span class="nx">logThenErrorf</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">Error</span><span class="p">())</span>
<a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="w">    </span><span class="c1">// Post proccessing of asset after LockAsset called like change status of the asset so that it can't be spent.</span>
<a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">contractId</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="p">}</span>
</code></pre></div>
   Here <code>assetExchangeAgreementSerializedProto64</code> is a serialized protobuf in Base64 encoded string of <code>AssetExchangeAgreement</code> protobuf structure, and can be used to extract details like asset id, type of asset and recipient. Check the structure definition <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/rfcs/formats/assets/exchange.md#representing-two-party-asset-exchange-agreements">here</a>.
   Similarly <code>lockInfoSerializedProto64</code> is a serialized protobuf in Base64 encoded string of <code>AssetLock</code> protobuf structure. Check the structure definition <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/rfcs/formats/assets/exchange.md#representing-locks-on-assets">here</a>.</li>
<li><strong>LockFungibleAsset</strong>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">LockFungibleAsset</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">fungibleAssetExchangeAgreementSerializedProto64</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">lockInfoSerializedProto64</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="w">    </span><span class="c1">// Add some safety checks before calling LockFungibleAsset from library</span>
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="w">    </span><span class="c1">// Caller of this chaincode is supposed to be the Locker and the owner of the asset being locked.</span>
<a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="w">    </span><span class="nx">contractId</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">amc</span><span class="p">.</span><span class="nx">LockFungibleAsset</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="s">""</span><span class="p">,</span><span class="w"> </span><span class="nx">fungibleAssetExchangeAgreementSerializedProto64</span><span class="p">,</span><span class="w"> </span><span class="nx">lockInfoSerializedProto64</span><span class="p">)</span>
<a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">""</span><span class="p">,</span><span class="w"> </span><span class="nx">logThenErrorf</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">Error</span><span class="p">())</span>
<a href="#__codelineno-10-7" id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-10-8" id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="w">    </span><span class="c1">// Post proccessing of asset after LockFungibleAsset called like reduce the amount of tokens owned by the locker, or mark it locked so that it can't be spent.</span>
<a href="#__codelineno-10-9" id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-10-10" id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">contractId</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<a href="#__codelineno-10-11" id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="p">}</span>
</code></pre></div>
   Here <code>fungibleAssetExchangeAgreementSerializedProto64</code> is a serialized protobuf in Base64 encoded string of <code>FungibleAssetExchangeAgreement</code> protobuf structure, and can be used to extract details like asset quantity, type of asset and recipient. Check the structure definition <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/rfcs/formats/assets/exchange.md#representing-two-party-asset-exchange-agreements">here</a>.</li>
<li><strong>IsAssetLockedQueryUsingContractId</strong>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">IsAssetLockedQueryUsingContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">amc</span><span class="p">.</span><span class="nx">IsAssetLockedQueryUsingContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="p">)</span>
<a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="p">}</span>
</code></pre></div></li>
<li><strong>ClaimAssetUsingContractId</strong>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">ClaimAssetUsingContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="p">,</span><span class="w"> </span><span class="nx">claimInfoSerializedProto64</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="w">    </span><span class="c1">// Note recipient will be the caller for this function</span>
<a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">    </span><span class="nx">claimed</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kc">false</span>
<a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="w">    </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">amc</span><span class="p">.</span><span class="nx">ClaimAssetUsingContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="p">,</span><span class="w"> </span><span class="nx">claimInfoSerializedProto64</span><span class="p">)</span>
<a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-12-6" id="__codelineno-12-6" name="__codelineno-12-6"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="nx">logThenErrorf</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">Error</span><span class="p">())</span>
<a href="#__codelineno-12-7" id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-12-8" id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="w">    </span><span class="nx">claimed</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-12-9" id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="w">    </span><span class="c1">// After the above function call, update the owner of the asset with recipeint/caller</span>
<a href="#__codelineno-12-10" id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-12-11" id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">claimed</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<a href="#__codelineno-12-12" id="__codelineno-12-12" name="__codelineno-12-12"></a><span class="p">}</span>
</code></pre></div></li>
<li><strong>UnlockAssetUsingContractId</strong>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">UnlockAssetUsingContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="w">    </span><span class="nx">unlocked</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kc">false</span>
<a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="w">    </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">amc</span><span class="p">.</span><span class="nx">UnlockAssetUsingContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="p">)</span>
<a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="nx">logThenErrorf</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">Error</span><span class="p">())</span>
<a href="#__codelineno-13-6" id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-13-7" id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="w">    </span><span class="nx">unlocked</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-13-8" id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="w">    </span><span class="o">...</span>
<a href="#__codelineno-13-9" id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">nil</span>
<a href="#__codelineno-13-10" id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="p">}</span>
</code></pre></div>
In addition, you should add the following extra utility functions to enable client applications to query and discover asset state:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">GetHTLCHashByContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">amc</span><span class="p">.</span><span class="nx">GetHTLCHashByContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="p">)</span>
<a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="p">}</span>
<a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">s</span><span class="w"> </span><span class="o">*</span><span class="nx">SmartContract</span><span class="p">)</span><span class="w"> </span><span class="nx">GetHTLCHashPreImageByContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="w"> </span><span class="nx">contractapi</span><span class="p">.</span><span class="nx">TransactionContextInterface</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">s</span><span class="p">.</span><span class="nx">amc</span><span class="p">.</span><span class="nx">GetHTLCHashPreImageByContractId</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="p">)</span>
<a href="#__codelineno-14-6" id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="p">}</span>
</code></pre></div></li>
</ol>
</li>
</ul>
<h4 id="for-asset-transfer">For Asset Transfer<a class="headerlink" href="#for-asset-transfer" title="Permanent link">¶</a></h4>
<p><em>TBD</em></p>
<h3 id="client-or-layer-2-applications">Client (or Layer-2) Applications<a class="headerlink" href="#client-or-layer-2-applications" title="Permanent link">¶</a></h3>
<p>Weaver provides an SDK to help you adapt your applications to exercise the various interoperability modes. These are called out as <strong>Interoperation Helpers</strong> in the network model illustrated earlier. Your Fabric network's Layer-2 applications have business logic embedded in them that, broadly speaking, accept data from users and other external agents and invoke smart contracts using library functions and APIs offered by the Fabric SDK. When you use Weaver for network interoperability, other options can be added, namely requesting and accepting data from foreign networks, and triggering locks and claims for atomic exchanges spanning two networks. Weaver's Fabric Interoperation SDK (currently implemented both in Node.js and Golang) offers a library to exercise these options, supplementing the Fabric SDK. But this will involve modification to the application's business logic.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">The instructions here apply to applications implemented in Node.js (JavaScript and TypeScript), using the Weaver Node SDK for Fabric. We will add instructions later for Go applications using the Weaver Go SDK for Fabric.</td>
</tr>
</tbody>
</table>
<p>To import and use the Weaver SDK, you need to add the following dependency to the <code>dependencies</code> section of your Node.js application's <code>package.json</code> file:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="nt">"@hyperledger/cacti-weaver-sdk-fabric"</span><span class="p">:</span><span class="w"> </span><span class="s2">"latest"</span><span class="p">,</span>
</code></pre></div>
(Instead of <code>latest</code>, you can select a particular version from the <a href="https://github.com/hyperledger-cacti/cacti/pkgs/npm/cacti-weaver-sdk-fabric">package website</a>.)</p>
<p>Before you run <code>npm install</code> to fetch the dependencies, make sure you create a <a href="https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token">personal access token</a> with <code>read:packages</code> access in GitHub. Create an <code>.npmrc</code> file in the same folder as the <code>package.json</code> with the following contents:</p>
<p><div class="highlight"><pre><span></span><code><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a>@hyperledger:registry=https://npm.pkg.github.com/hyperledger
<a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a>//npm.pkg.github.com/:_authToken=&lt;personal-access-token&gt;
</code></pre></div>
Replace <code>&lt;personal-access-token&gt;</code> in this file with the token you created in GitHub.</p>
<p>First, you must incorporate some code for Weaver's network administration, specifically identity management. Then, using the given sample code and examples, you can adapt your applications for each interoperability mode.</p>
<h4 id="for-identity-administration">For Identity Administration<a class="headerlink" href="#for-identity-administration" title="Permanent link">¶</a></h4>
<p>A Fabric network channel must share its security domain (or membership) configuration, i.e., its organizations' CA certificate chains, with a foreign network with which it seeks to interoperate. Each organization must run an IIN Agent for this purpose. The set of IIN Agents, a.k.a. the <em>local membership</em> must be recorded in the ledger before those agents can be operational. In your Fabric network application suite, one or more applications will exist for network administration; the following code snippet should be added in at least one of those applications to record local membership as a prerequisite for interoperability:
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">MembershipManager</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">'@hyperledger/cacti-weaver-sdk-fabric'</span>
<a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a>
<a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">gateway</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">get</span><span class="o">-</span><span class="nx">fabric</span><span class="o">-</span><span class="nx">network</span><span class="o">-</span><span class="nx">gateway</span><span class="o">-</span><span class="nx">instance</span><span class="o">&gt;</span>
<a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a>
<a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-17-6" id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">MembershipManager</span><span class="p">.</span><span class="nx">createLocalMembership</span><span class="p">(</span>
<a href="#__codelineno-17-7" id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="w">        </span><span class="nx">gateway</span><span class="p">,</span>
<a href="#__codelineno-17-8" id="__codelineno-17-8" name="__codelineno-17-8"></a><span class="w">        </span><span class="nx">members</span><span class="p">,</span><span class="w">        </span><span class="c1">// list of all organization MSPIDs that are part of the channel</span>
<a href="#__codelineno-17-9" id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="w">        </span><span class="nx">securityDomain</span><span class="p">,</span><span class="w"> </span><span class="c1">// name of the local network's security domain</span>
<a href="#__codelineno-17-10" id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="w">        </span><span class="nx">channelName</span><span class="p">,</span><span class="w">    </span><span class="c1">// Channel Name</span>
<a href="#__codelineno-17-11" id="__codelineno-17-11" name="__codelineno-17-11"></a><span class="w">        </span><span class="nx">contractName</span><span class="w">    </span><span class="c1">// Fabric Interoperation Chaincode installation ID on the channel</span>
<a href="#__codelineno-17-12" id="__codelineno-17-12" name="__codelineno-17-12"></a><span class="w">    </span><span class="p">)</span>
<a href="#__codelineno-17-13" id="__codelineno-17-13" name="__codelineno-17-13"></a><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-17-14" id="__codelineno-17-14" name="__codelineno-17-14"></a><span class="w">    </span><span class="c1">// On error try updating local membership</span>
<a href="#__codelineno-17-15" id="__codelineno-17-15" name="__codelineno-17-15"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">MembershipManager</span><span class="p">.</span><span class="nx">updateLocalMembership</span><span class="p">(</span><span class="nx">gateway</span><span class="p">,</span><span class="w"> </span><span class="nx">members</span><span class="p">,</span><span class="w"> </span><span class="nx">securityDomain</span><span class="p">,</span><span class="w"> </span><span class="nx">channelName</span><span class="p">,</span><span class="w"> </span><span class="nx">contractName</span><span class="p">)</span>
<a href="#__codelineno-17-16" id="__codelineno-17-16" name="__codelineno-17-16"></a><span class="p">}</span>
</code></pre></div></p>
<ul>
<li><code>&lt;get-fabric-network-gateway-instance&gt;</code> should be replaced with standard (boilerplate) code to get a handle to your network's gateway. This requires a special wallet identity, namely one with a <code>network-admin</code> attribute indicating that the caller is a trusted network administrator who is authorized to record local memberships on the <code>channelName</code> channel.</li>
<li><code>members</code> must consist of the list of organizational MSP IDs for the <code>channelName</code> channel.</li>
</ul>
<h4 id="for-data-sharing_1">For Data Sharing<a class="headerlink" href="#for-data-sharing_1" title="Permanent link">¶</a></h4>
<p>Consider a scenario inspired by the <a href="../../../user-stories/global-trade/">global trade use case</a> where a letter of credit (L/C) management business logic (chaincode <code>letterofcreditcc</code>) installed in the <code>tradefinancechannel</code> channel in the <code>trade-finance-network</code> network supports a transaction <code>RecordBillOfLading</code>, which validates and records a bill of lading (B/L) supplied by a user via a UI. Weaver will enable such a B/L to be fetched from a different network <code>trade-logistics-network</code> by querying the function <code>GetBillOfLading</code> exposed by the chaincode <code>shipmentcc</code> installed in the <code>tradelogisticschannel</code> channel.</p>
<p>(In preparation, a suitable access control policy must be recorded on <code>tradelogisticschannel</code> in <code>trade-logistics-network</code>, and a suitable verification policy must be recorded on <code>tradefinancechannel</code> in <code>trade-finance-network</code>. We will see how to do this in the "Startup and Boostrap" section later.)</p>
<p>You will need to insert some code in the Layer-2 application that accepts a B/L and submits a <code>RecordBillOfLading</code> transaction in <code>trade-finance-network</code>. (No code changes need to be made in any application in the other network.) The logic to accept a B/L should be replaced (or you can simply add an alternative) by a call to the <code>interopFlow</code> function offered by the <a href="https://github.com/hyperledger-cacti/cacti/pkgs/npm/cacti-weaver-sdk-fabric">cacti-weaver-sdk-fabric</a> library (there's an <a href="https://github.com/hyperledger-cacti/cacti/releases/tag/weaver%2Fsdks%2Ffabric%2Fgo-sdk%2Fv2.0.0">equivalent library in Golang</a> too). The following code sample illustrates this (the Golang equivalent is left to the reader):
<div class="highlight"><pre><span></span><code><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">ihelper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">'@hyperledger/cacti-weaver-sdk-fabric'</span><span class="p">).</span><span class="nx">InteroperableHelper</span><span class="p">;</span>
<a href="#__codelineno-18-2" id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="kd">const</span><span class="w"> </span><span class="nx">interopcc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">handle</span><span class="o">-</span><span class="nx">to</span><span class="o">-</span><span class="nx">fabric</span><span class="o">-</span><span class="nx">interop</span><span class="o">-</span><span class="nx">chaincode</span><span class="o">&gt;</span><span class="p">;</span><span class="w">   </span><span class="c1">// Use Fabric SDK functions: (new Gateway()).getNetwork(...).getContract(&lt;fabric-interop-chaincode-id&gt;)</span>
<a href="#__codelineno-18-3" id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">keyCert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">ihelper</span><span class="p">.</span><span class="nx">getKeyAndCertForRemoteRequestbyUserName</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">wallet</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">user</span><span class="o">-</span><span class="nx">id</span><span class="o">&gt;</span><span class="p">);</span><span class="w">      </span><span class="c1">// Read key and certificate for &lt;user-id&gt; from wallet (get handle using Fabric SDK Wallets API)</span>
<a href="#__codelineno-18-4" id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="c1">// Collect view addresses for relay requests in the context of an interop flow</span>
<a href="#__codelineno-18-5" id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="nx">interopJSONs</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
<a href="#__codelineno-18-6" id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="w">    </span><span class="nx">NetworkID</span><span class="o">:</span><span class="w"> </span><span class="s1">'trade-logistics-network'</span><span class="p">,</span>
<a href="#__codelineno-18-7" id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="w">    </span><span class="nx">RemoteEndpoint</span><span class="o">:</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">trade</span><span class="o">-</span><span class="nx">logistics</span><span class="o">-</span><span class="nx">relay</span><span class="o">-</span><span class="nx">url</span><span class="p">[</span><span class="o">:&lt;</span><span class="nx">port</span><span class="o">&gt;</span><span class="p">],</span><span class="w">      </span><span class="c1">// Replace with remote network's relay address and port</span>
<a href="#__codelineno-18-8" id="__codelineno-18-8" name="__codelineno-18-8"></a><span class="w">    </span><span class="nx">ChannelID</span><span class="o">:</span><span class="w"> </span><span class="s1">'tradelogisticschannel'</span><span class="p">,</span>
<a href="#__codelineno-18-9" id="__codelineno-18-9" name="__codelineno-18-9"></a><span class="w">    </span><span class="nx">ChaincodeID</span><span class="o">:</span><span class="w"> </span><span class="s1">'shipmentcc'</span><span class="p">,</span>
<a href="#__codelineno-18-10" id="__codelineno-18-10" name="__codelineno-18-10"></a><span class="w">    </span><span class="nx">ChaincodeFunc</span><span class="o">:</span><span class="w"> </span><span class="s1">'GetBillOfLading'</span><span class="p">,</span>
<a href="#__codelineno-18-11" id="__codelineno-18-11" name="__codelineno-18-11"></a><span class="w">    </span><span class="nx">ccArgs</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">shipment</span><span class="o">-</span><span class="nx">reference</span><span class="o">&gt;</span><span class="w"> </span><span class="p">],</span><span class="w">     </span><span class="c1">// Replace &lt;shipment-reference&gt; with a value that can be used to look up the right B/L</span>
<a href="#__codelineno-18-12" id="__codelineno-18-12" name="__codelineno-18-12"></a><span class="w">    </span><span class="nx">Sign</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span>
<a href="#__codelineno-18-13" id="__codelineno-18-13" name="__codelineno-18-13"></a><span class="p">});</span>
<a href="#__codelineno-18-14" id="__codelineno-18-14" name="__codelineno-18-14"></a><span class="kd">const</span><span class="w"> </span><span class="nx">indices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="p">];</span>
<a href="#__codelineno-18-15" id="__codelineno-18-15" name="__codelineno-18-15"></a><span class="c1">// Trigger an end-to-end interoperation (data sharing) protocol</span>
<a href="#__codelineno-18-16" id="__codelineno-18-16" name="__codelineno-18-16"></a><span class="c1">// Send a request to a foreign network via your relay, receive the response and submit a transaction to a local chaincode</span>
<a href="#__codelineno-18-17" id="__codelineno-18-17" name="__codelineno-18-17"></a><span class="kd">const</span><span class="w"> </span><span class="nx">flowResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">ihelper</span><span class="p">.</span><span class="nx">interopFlow</span><span class="p">(</span>
<a href="#__codelineno-18-18" id="__codelineno-18-18" name="__codelineno-18-18"></a><span class="w">    </span><span class="nx">interopcc</span><span class="p">,</span>
<a href="#__codelineno-18-19" id="__codelineno-18-19" name="__codelineno-18-19"></a><span class="w">    </span><span class="s1">'trade-finance-network'</span><span class="p">,</span>
<a href="#__codelineno-18-20" id="__codelineno-18-20" name="__codelineno-18-20"></a><span class="w">    </span><span class="p">{</span>
<a href="#__codelineno-18-21" id="__codelineno-18-21" name="__codelineno-18-21"></a><span class="w">        </span><span class="nx">channel</span><span class="o">:</span><span class="w"> </span><span class="s1">'tradefinancechannel'</span><span class="p">,</span>
<a href="#__codelineno-18-22" id="__codelineno-18-22" name="__codelineno-18-22"></a><span class="w">        </span><span class="nx">contractName</span><span class="o">:</span><span class="w"> </span><span class="s1">'letterofcreditcc'</span><span class="p">,</span>
<a href="#__codelineno-18-23" id="__codelineno-18-23" name="__codelineno-18-23"></a><span class="w">        </span><span class="nx">ccFunc</span><span class="o">:</span><span class="w"> </span><span class="s1">'RecordBillOfLading'</span><span class="p">,</span>
<a href="#__codelineno-18-24" id="__codelineno-18-24" name="__codelineno-18-24"></a><span class="w">        </span><span class="nx">ccArgs</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">shipment</span><span class="o">-</span><span class="nx">reference</span><span class="o">&gt;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s1">''</span><span class="w"> </span><span class="p">]</span>
<a href="#__codelineno-18-25" id="__codelineno-18-25" name="__codelineno-18-25"></a><span class="w">    </span><span class="p">},</span>
<a href="#__codelineno-18-26" id="__codelineno-18-26" name="__codelineno-18-26"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">org</span><span class="o">-</span><span class="nx">msp</span><span class="o">-</span><span class="nx">id</span><span class="o">&gt;</span><span class="p">,</span><span class="w">                         </span><span class="c1">// Replace with this Layer-2 application's organization's MSP ID</span>
<a href="#__codelineno-18-27" id="__codelineno-18-27" name="__codelineno-18-27"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">trade</span><span class="o">-</span><span class="nx">finance</span><span class="o">-</span><span class="nx">relay</span><span class="o">-</span><span class="nx">url</span><span class="o">&gt;</span><span class="p">[</span><span class="o">:&lt;</span><span class="nx">port</span><span class="o">&gt;</span><span class="p">],</span><span class="w">   </span><span class="c1">// Replace with local network's relay address and port</span>
<a href="#__codelineno-18-28" id="__codelineno-18-28" name="__codelineno-18-28"></a><span class="w">    </span><span class="nx">indices</span><span class="p">,</span>
<a href="#__codelineno-18-29" id="__codelineno-18-29" name="__codelineno-18-29"></a><span class="w">    </span><span class="nx">interopJSONs</span><span class="p">,</span>
<a href="#__codelineno-18-30" id="__codelineno-18-30" name="__codelineno-18-30"></a><span class="w">    </span><span class="nx">keyCert</span><span class="p">,</span>
<a href="#__codelineno-18-31" id="__codelineno-18-31" name="__codelineno-18-31"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">endorsingOrgs</span><span class="o">&gt;</span><span class="p">,</span><span class="w">        </span><span class="c1">// List of orgs to submit transaction to local i.e. trade logistics network</span>
<a href="#__codelineno-18-32" id="__codelineno-18-32" name="__codelineno-18-32"></a><span class="w">    </span><span class="kc">false</span><span class="p">,</span><span class="w">                  </span><span class="c1">// Boolean flag to indicate whether return without submit transaction to local i.e. trade logistics network</span>
<a href="#__codelineno-18-33" id="__codelineno-18-33" name="__codelineno-18-33"></a><span class="w">    </span><span class="kc">false</span><span class="p">,</span><span class="w">                  </span><span class="c1">// Boolean flag indicating no TLS communication with relay</span>
<a href="#__codelineno-18-34" id="__codelineno-18-34" name="__codelineno-18-34"></a><span class="w">    </span><span class="p">[],</span><span class="w">                     </span><span class="c1">// Keep it empty when TLS is disabled</span>
<a href="#__codelineno-18-35" id="__codelineno-18-35" name="__codelineno-18-35"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">confidential</span><span class="o">-</span><span class="nx">flag</span><span class="o">&gt;</span><span class="p">,</span><span class="w">    </span><span class="c1">// Boolean flag to indicate whether to use to end-to-end encryption</span>
<a href="#__codelineno-18-36" id="__codelineno-18-36" name="__codelineno-18-36"></a><span class="p">);</span>
<a href="#__codelineno-18-37" id="__codelineno-18-37" name="__codelineno-18-37"></a><span class="c1">// List of errors to check for</span>
<a href="#__codelineno-18-38" id="__codelineno-18-38" name="__codelineno-18-38"></a><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">flowResponse</span><span class="p">.</span><span class="nx">views</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">flowResponse</span><span class="p">.</span><span class="nx">views</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">flowResponse</span><span class="p">.</span><span class="nx">result</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">flowResponse</span><span class="p">.</span><span class="nx">views</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="nx">argIndices</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-18-39" id="__codelineno-18-39" name="__codelineno-18-39"></a><span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">error</span><span class="o">&gt;</span><span class="p">;</span>
<a href="#__codelineno-18-40" id="__codelineno-18-40" name="__codelineno-18-40"></a><span class="p">}</span>
</code></pre></div>
Let us understand this code snippet better. The structure in lines 20-25 specifies the local chaincode transaction that is to be triggered after remote data (view) has been requested and obtained via relays. The function <code>RecordBillOfLading</code> expects two arguments as specified in line 24: the first is the common shipment reference that is used by the letter of credit in <code>trade-finance-network</code> and the bill of lading in <code>trade-logistics-network</code>, and the second is the bill of lading contents. When the <code>interopFlow</code> function is called, this argument is left blank because it is supposed to be filled with contents obtained from a view request. The array list <code>indices</code>, which is passed as an argument to <code>interopFlow</code> therefore contains the index value <code>1</code> (line 14), indicating which argument ought to be substituted  with view data. The <code>interopJSONs</code> array correspondingly contains a list of view addresses that are to be supplied to the relay. The <code>&lt;confidential-flag&gt;</code> if set to <code>true</code> will enable end-to-end confidentiality, i.e. payload will be encrypted from <code>trade-finance-network</code>'s Weaver chaincode, and will be decrypted in SDK (i.e. Layer-2 client application) at <code>trade-logistics-network</code>, but relays and drivers in between will not be able to see the payload. By default this flag is set to <code>false</code>.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">A local chaincode invocation may require multiple view requests to different networks, which is why <code>indices</code> and <code>interopJSONs</code> are arrays; they therefore must have the same lengths.</td>
</tr>
</tbody>
</table>
<p>The rest of the code ought to be self-explanatory. Values are hardcoded for explanation purposes, but you can refactor the above code by reading view addresses corresponding to chaincode invocations from a configuration file.</p>
<p><strong>Enabling TLS</strong>:
By default, the TLS is set to false in <code>interopFlow</code>, i.e. disabled. But if you want to enable TLS, can pass additional parameters to the <code>interopFlow</code> function as follows:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-19-1" id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">flowResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">ihelper</span><span class="p">.</span><span class="nx">interopFlow</span><span class="p">(</span>
<a href="#__codelineno-19-2" id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="w">    </span><span class="nx">interopcc</span><span class="p">,</span>
<a href="#__codelineno-19-3" id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="w">    </span><span class="s1">'trade-finance-network'</span><span class="p">,</span>
<a href="#__codelineno-19-4" id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="w">    </span><span class="p">{</span>
<a href="#__codelineno-19-5" id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="w">        </span><span class="nx">channel</span><span class="o">:</span><span class="w"> </span><span class="s1">'tradefinancechannel'</span><span class="p">,</span>
<a href="#__codelineno-19-6" id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="w">        </span><span class="nx">contractName</span><span class="o">:</span><span class="w"> </span><span class="s1">'letterofcreditcc'</span><span class="p">,</span>
<a href="#__codelineno-19-7" id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="w">        </span><span class="nx">ccFunc</span><span class="o">:</span><span class="w"> </span><span class="s1">'RecordBillOfLading'</span><span class="p">,</span>
<a href="#__codelineno-19-8" id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="w">        </span><span class="nx">ccArgs</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">shipment</span><span class="o">-</span><span class="nx">reference</span><span class="o">&gt;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s1">''</span><span class="w"> </span><span class="p">]</span>
<a href="#__codelineno-19-9" id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="w">    </span><span class="p">},</span>
<a href="#__codelineno-19-10" id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">org</span><span class="o">-</span><span class="nx">msp</span><span class="o">-</span><span class="nx">id</span><span class="o">&gt;</span><span class="p">,</span><span class="w">                         </span><span class="c1">// Replace with this Layer-2 application's organization's MSP ID</span>
<a href="#__codelineno-19-11" id="__codelineno-19-11" name="__codelineno-19-11"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">trade</span><span class="o">-</span><span class="nx">finance</span><span class="o">-</span><span class="nx">relay</span><span class="o">-</span><span class="nx">url</span><span class="o">&gt;</span><span class="p">[</span><span class="o">:&lt;</span><span class="nx">port</span><span class="o">&gt;</span><span class="p">],</span><span class="w">   </span><span class="c1">// Replace with local network's relay address and port</span>
<a href="#__codelineno-19-12" id="__codelineno-19-12" name="__codelineno-19-12"></a><span class="w">    </span><span class="nx">indices</span><span class="p">,</span>
<a href="#__codelineno-19-13" id="__codelineno-19-13" name="__codelineno-19-13"></a><span class="w">    </span><span class="nx">interopJSONs</span><span class="p">,</span>
<a href="#__codelineno-19-14" id="__codelineno-19-14" name="__codelineno-19-14"></a><span class="w">    </span><span class="nx">keyCert</span><span class="p">,</span>
<a href="#__codelineno-19-15" id="__codelineno-19-15" name="__codelineno-19-15"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">endorsingOrgs</span><span class="o">&gt;</span><span class="p">,</span><span class="w">            </span><span class="c1">// List of orgs to submit transaction to in trade logistics network</span>
<a href="#__codelineno-19-16" id="__codelineno-19-16" name="__codelineno-19-16"></a><span class="w">    </span><span class="kc">false</span><span class="p">,</span><span class="w">                  </span><span class="c1">// Boolean flag to indicate whether return without submit transaction to local i.e. trade logistics network</span>
<a href="#__codelineno-19-17" id="__codelineno-19-17" name="__codelineno-19-17"></a><span class="w">    </span><span class="kc">true</span><span class="p">,</span><span class="w">                       </span><span class="c1">// Boolean indication TLS is enabled.</span>
<a href="#__codelineno-19-18" id="__codelineno-19-18" name="__codelineno-19-18"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">tlsCACertPathsForRelay</span><span class="o">&gt;</span><span class="p">,</span><span class="w">   </span><span class="c1">// list of CA certificate file paths</span>
<a href="#__codelineno-19-19" id="__codelineno-19-19" name="__codelineno-19-19"></a><span class="p">);</span>
</code></pre></div></p>
<h4 id="for-asset-exchange_1">For Asset Exchange<a class="headerlink" href="#for-asset-exchange_1" title="Permanent link">¶</a></h4>
<p>Let's take an example of asset exchange between <code>Alice</code> and <code>Bob</code>, where Bob wants to purchase an asset of type <code>Gold</code> with id <code>A123</code> from <code>Alice</code> in <code>BondNetwork</code> in exchange for <code>200</code> tokens of type <code>CBDC01</code> in <code>TokenNetwork</code>.</p>
<p><code>Alice</code> needs to select a secret text (say <code>s</code>), and hash it (say <code>H</code>) using say <code>SHA512</code>, which will be used to lock her asset in <code>BondNetwork</code>. At the place in your application where an asset exchange is to be initiated, you need to add code to enable Alice to lock the non-fungible asset using hash <code>H</code> and timeout duration of 10 minutes:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">AssetManager</span><span class="p">,</span><span class="w"> </span><span class="nx">HashFunctions</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">'@hyperledger/cacti-weaver-sdk-fabric'</span>
<a href="#__codelineno-20-2" id="__codelineno-20-2" name="__codelineno-20-2"></a>
<a href="#__codelineno-20-3" id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">HashFunctions</span><span class="p">.</span><span class="nx">SHA512</span><span class="p">();</span><span class="w">    </span><span class="c1">// Create Hash instance of one of the supported Hash Algorithm</span>
<a href="#__codelineno-20-4" id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="nx">hash</span><span class="p">.</span><span class="nx">setSerializedHashBase64</span><span class="p">(</span><span class="nx">H</span><span class="p">);</span><span class="w">        </span><span class="c1">// Set the Hash</span>
<a href="#__codelineno-20-5" id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="kd">const</span><span class="w"> </span><span class="nx">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">/</span><span class="mf">1000</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">10</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="p">;</span>
<a href="#__codelineno-20-6" id="__codelineno-20-6" name="__codelineno-20-6"></a>
<a href="#__codelineno-20-7" id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="kd">const</span><span class="w"> </span><span class="nx">bondContract</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">handle</span><span class="o">-</span><span class="nx">to</span><span class="o">-</span><span class="nx">fabric</span><span class="o">-</span><span class="nx">application</span><span class="o">-</span><span class="nx">chaincode</span><span class="o">-</span><span class="ow">in</span><span class="o">-</span><span class="nx">bond</span><span class="o">-</span><span class="nx">network</span><span class="o">&gt;</span><span class="p">;</span>
<a href="#__codelineno-20-8" id="__codelineno-20-8" name="__codelineno-20-8"></a>
<a href="#__codelineno-20-9" id="__codelineno-20-9" name="__codelineno-20-9"></a><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">AssetManager</span><span class="p">.</span><span class="nx">createHTLC</span><span class="p">(</span>
<a href="#__codelineno-20-10" id="__codelineno-20-10" name="__codelineno-20-10"></a><span class="w">    </span><span class="nx">bondContract</span><span class="p">,</span>
<a href="#__codelineno-20-11" id="__codelineno-20-11" name="__codelineno-20-11"></a><span class="w">    </span><span class="s2">"Gold"</span><span class="p">,</span><span class="w">             </span><span class="c1">// Asset ID</span>
<a href="#__codelineno-20-12" id="__codelineno-20-12" name="__codelineno-20-12"></a><span class="w">    </span><span class="s2">"A123"</span><span class="p">,</span><span class="w">             </span><span class="c1">// Asset Type</span>
<a href="#__codelineno-20-13" id="__codelineno-20-13" name="__codelineno-20-13"></a><span class="w">    </span><span class="nx">bobCertificate</span><span class="p">,</span><span class="w">     </span><span class="c1">// Certificate of Bob in Bond Network</span>
<a href="#__codelineno-20-14" id="__codelineno-20-14" name="__codelineno-20-14"></a><span class="w">    </span><span class="nx">hash</span><span class="p">,</span><span class="w">                  </span><span class="c1">// Hash generated by Alice using her secret s</span>
<a href="#__codelineno-20-15" id="__codelineno-20-15" name="__codelineno-20-15"></a><span class="w">    </span><span class="nx">timeout</span><span class="p">,</span><span class="w">            </span><span class="c1">// Timeout in epoch for 10 mins from current time</span>
<a href="#__codelineno-20-16" id="__codelineno-20-16" name="__codelineno-20-16"></a><span class="w">    </span><span class="kc">null</span><span class="w">                </span><span class="c1">// Optional callback function to be called after the asset is locked</span>
<a href="#__codelineno-20-17" id="__codelineno-20-17" name="__codelineno-20-17"></a><span class="p">);</span>
<a href="#__codelineno-20-18" id="__codelineno-20-18" name="__codelineno-20-18"></a><span class="kd">let</span><span class="w"> </span><span class="nx">bondContractId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">result</span><span class="p">;</span><span class="w"> </span><span class="c1">// Unique ID for this asset exchange contract in BondNetwork</span>
</code></pre></div></p>
<table>
<thead>
<tr>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Note that 'Alice' and 'Bob' and the asset specifics can be parameterized in the above code, which can be reused for arbitrary asset exchange scenarios in your business workflow. The above code is only meant to be a sample.</td>
</tr>
</tbody>
</table>
<p>Now <code>Bob</code> will lock his tokens in <code>TokenNetwork</code>. To lock the fungible asset using same hash <code>H</code> and timeout of 5 minutes (half the timeout duration used by Alice in <code>BondNetwork</code>), add the following code snippet in your application:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-21-1" id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">HashFunctions</span><span class="p">.</span><span class="nx">SHA512</span><span class="p">();</span><span class="w">    </span><span class="c1">// Create Hash instance of one of the supported Hash Algorithm</span>
<a href="#__codelineno-21-2" id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="nx">hash</span><span class="p">.</span><span class="nx">setSerializedHashBase64</span><span class="p">(</span><span class="nx">H</span><span class="p">);</span><span class="w">        </span><span class="c1">// Set the Hash</span>
<a href="#__codelineno-21-3" id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">/</span><span class="mf">1000</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">60</span><span class="p">;</span>
<a href="#__codelineno-21-4" id="__codelineno-21-4" name="__codelineno-21-4"></a>
<a href="#__codelineno-21-5" id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="kd">const</span><span class="w"> </span><span class="nx">tokenContract</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">handle</span><span class="o">-</span><span class="nx">to</span><span class="o">-</span><span class="nx">fabric</span><span class="o">-</span><span class="nx">application</span><span class="o">-</span><span class="nx">chaincode</span><span class="o">-</span><span class="ow">in</span><span class="o">-</span><span class="nx">token</span><span class="o">-</span><span class="nx">network</span><span class="o">&gt;</span><span class="p">;</span>
<a href="#__codelineno-21-6" id="__codelineno-21-6" name="__codelineno-21-6"></a><span class="kd">const</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">AssetManager</span><span class="p">.</span><span class="nx">createFungibleHTLC</span><span class="p">(</span>
<a href="#__codelineno-21-7" id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="w">    </span><span class="nx">tokenContract</span><span class="p">,</span>
<a href="#__codelineno-21-8" id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="w">    </span><span class="s2">"CBDC01"</span><span class="p">,</span><span class="w">               </span><span class="c1">// Token ID</span>
<a href="#__codelineno-21-9" id="__codelineno-21-9" name="__codelineno-21-9"></a><span class="w">    </span><span class="mf">200</span><span class="p">,</span><span class="w">                    </span><span class="c1">// Token Quantity</span>
<a href="#__codelineno-21-10" id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="w">    </span><span class="nx">aliceCertificate</span><span class="p">,</span><span class="w">       </span><span class="c1">// Certificate of Alice in Token Network</span>
<a href="#__codelineno-21-11" id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="w">    </span><span class="nx">hash</span><span class="p">,</span><span class="w">                      </span><span class="c1">// Hash H used by Alice in Bond Network</span>
<a href="#__codelineno-21-12" id="__codelineno-21-12" name="__codelineno-21-12"></a><span class="w">    </span><span class="nx">timeout</span><span class="p">,</span><span class="w">                </span><span class="c1">// Timeout in epoch for 5 mins from current time</span>
<a href="#__codelineno-21-13" id="__codelineno-21-13" name="__codelineno-21-13"></a><span class="w">    </span><span class="kc">null</span><span class="w">                    </span><span class="c1">// Optional callback function to be called after the asset is locked</span>
<a href="#__codelineno-21-14" id="__codelineno-21-14" name="__codelineno-21-14"></a><span class="p">)</span>
<a href="#__codelineno-21-15" id="__codelineno-21-15" name="__codelineno-21-15"></a><span class="kd">const</span><span class="w"> </span><span class="nx">tokenContractId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">result</span><span class="w"> </span><span class="c1">// Unique ID for this asset exchange contract in TokenNetwork</span>
</code></pre></div></p>
<p>Wherever the lock status of the asset is required in your application, you should insert a query function call as follows:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-22-1" id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">contract</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">handle</span><span class="o">-</span><span class="nx">to</span><span class="o">-</span><span class="nx">fabric</span><span class="o">-</span><span class="nx">application</span><span class="o">-</span><span class="nx">chaincode</span><span class="o">&gt;</span><span class="p">;</span>
<a href="#__codelineno-22-2" id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="c1">// Below contractId is the ID obtained during lock</span>
<a href="#__codelineno-22-3" id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">isLocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">AssetManager</span><span class="p">.</span><span class="nx">isAssetLockedInHTLCqueryUsingContractId</span><span class="p">(</span><span class="nx">contract</span><span class="p">,</span><span class="w"> </span><span class="nx">contractId</span><span class="p">)</span>
</code></pre></div></p>
<p>Wherever a participant (either 'Alice' or 'Bob' in this example) needs to claim a locked asset using the secret text (pre-image of hash) <code>s</code> in your application, insert the following code snippet (<em>Note</em>: typically one would insert this in event callback functions or in functions that are polling the ledger to monitor whether the asset is locked in favor of a given recipient):
<div class="highlight"><pre><span></span><code><a href="#__codelineno-23-1" id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">hash</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">HashFunctions</span><span class="p">.</span><span class="nx">SHA512</span><span class="p">();</span><span class="w">    </span><span class="c1">// Create Hash instance of one of the supported Hash Algorithm</span>
<a href="#__codelineno-23-2" id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="nx">hash</span><span class="p">.</span><span class="nx">setPreimage</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span><span class="w">                     </span><span class="c1">// Set Pre-Image s</span>
<a href="#__codelineno-23-3" id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">contract</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">handle</span><span class="o">-</span><span class="nx">to</span><span class="o">-</span><span class="nx">fabric</span><span class="o">-</span><span class="nx">application</span><span class="o">-</span><span class="nx">chaincode</span><span class="o">&gt;</span><span class="p">;</span>
<a href="#__codelineno-23-4" id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="kd">const</span><span class="w"> </span><span class="nx">claimSuccess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">AssetManager</span><span class="p">.</span><span class="nx">claimAssetInHTLCusingContractId</span><span class="p">(</span>
<a href="#__codelineno-23-5" id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="w">    </span><span class="nx">contract</span><span class="p">,</span>
<a href="#__codelineno-23-6" id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="w">    </span><span class="nx">contractId</span><span class="p">,</span><span class="w">                         </span><span class="c1">// contractId obtained during lock</span>
<a href="#__codelineno-23-7" id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="w">    </span><span class="nx">hash</span>
<a href="#__codelineno-23-8" id="__codelineno-23-8" name="__codelineno-23-8"></a><span class="p">)</span>
<a href="#__codelineno-23-9" id="__codelineno-23-9" name="__codelineno-23-9"></a><span class="c1">// return value claimSuccess is boolean indicating success or failure of claim</span>
</code></pre></div></p>
<p>Wherever the asset must be unlocked in your application (typically, an event callback function triggered upon the expiration of the time lock), insert the following code snippet:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-24-1" id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="kd">const</span><span class="w"> </span><span class="nx">contract</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;</span><span class="nx">handle</span><span class="o">-</span><span class="nx">to</span><span class="o">-</span><span class="nx">fabric</span><span class="o">-</span><span class="nx">application</span><span class="o">-</span><span class="nx">chaincode</span><span class="o">&gt;</span><span class="p">;</span>
<a href="#__codelineno-24-2" id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="kd">const</span><span class="w"> </span><span class="nx">reclaimSuccess</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">AssetManager</span><span class="p">.</span><span class="nx">reclaimAssetInHTLCusingContractId</span><span class="p">(</span>
<a href="#__codelineno-24-3" id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="w">    </span><span class="nx">contract</span><span class="p">,</span>
<a href="#__codelineno-24-4" id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="w">    </span><span class="nx">contractId</span><span class="w">                          </span><span class="c1">// contractId obtained during lock</span>
<a href="#__codelineno-24-5" id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="p">)</span>
<a href="#__codelineno-24-6" id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="c1">// return value 'reclaimSuccess' is a boolean indicating success or failure of reclaim</span>
</code></pre></div></p>
<h4 id="for-asset-transfer_1">For Asset Transfer<a class="headerlink" href="#for-asset-transfer_1" title="Permanent link">¶</a></h4>
<p><em>TBD</em></p>
<h2 id="pre-configuration-phase">Pre-Configuration Phase<a class="headerlink" href="#pre-configuration-phase" title="Permanent link">¶</a></h2>
<p>Typically, pre-configuration in a Fabric network involves generating (after creating the channel specifications and policies):</p>
<ul>
<li><em>Channel artifacts</em>: orderer genesis block, channel transaction, and anchor peer configurations from a <code>configtx.yaml</code> file (using Fabric's <code>configtxgen</code> tool)</li>
<li><em>Crypto artifacts</em>: keys and certificates for CAs, peers, orderers, and clients from a <code>crypto-config.yaml</code> file (using Fabric's <code>cryptogen</code> tool)</li>
<li><em>Connection profiles</em>: one for every network organization, which will be used by the organization's Layer-2 applications to connect to the network's peers and CAs</li>
</ul>
<p>No changes are required in this process to support any of the three interoperation modes using Weaver. The connection profiles generated above will be used by certain Weaver modules, as we will see later. The only additional step required is to generate special wallet identities for the following:</p>
<ul>
<li>Network administrator: one or more identities containing the <code>network-admin</code> attribute; only a user/application possessing this identity may record special (privileged) information regarding memberships and policies on the channel.</li>
<li>Fabric Driver: one or more identities (for each deployed driver) containing the <code>relay</code> attribute; only a relay-driver combination possessing this identity may run data sharing-related operations on the deployed Fabric Interoperation Chaincode.</li>
<li>IIN Agent: one or more identities (for each deployed agent) containing the <code>iin-agent</code> attribute: only an agent may submit foreign network membership records to the Fabric Interoperation Chaincode.</li>
</ul>
<p>Later we will see how the components possessing these identities are deployed.</p>
<h2 id="startup-and-bootstrap-phase">Startup and Bootstrap Phase<a class="headerlink" href="#startup-and-bootstrap-phase" title="Permanent link">¶</a></h2>
<p>After writing application code and creating the network configuration files, the components of a Fabric network (peers, CAs, and ordering service) are launched. In this section, we will list the additional tasks you, as a Fabric network administrator, must perform to make your network ready to interoperate.</p>
<p>To launch a network using containerized components, you will typically use a Docker Compose or Kubernetes configuration file. No modifications are needed to the peers', orderers', and CAs' configurations. Sample instructions are given below for networks launched using Docker Compose; we leave it to the reader to adapt these to their custom launch processes.</p>
<h3 id="for-asset-exchange_2">For Asset Exchange<a class="headerlink" href="#for-asset-exchange_2" title="Permanent link">¶</a></h3>
<p>The asset exchange mode currently requires only the Fabric Interoperation Chaincode module from Weaver. Relays, drivers, and IIN agents, are not necessary. In the future, we expect to make the asset exchange protocol moe automated using these components; the instructions here will be updated appropriately.</p>
<h4 id="install-the-fabric-interoperation-chaincode">Install the Fabric Interoperation Chaincode<a class="headerlink" href="#install-the-fabric-interoperation-chaincode" title="Permanent link">¶</a></h4>
<p>Install the Fabric Interoperation Chaincode in the relevant channel(s), i.e., those that run chaincodes that will be involved in asset exchanges. This is a Go module that can be fetched from <code>github.com/hyperledger/cacti/weaver/core/network/fabric-interop-cc/contracts/interop</code>. Following that, you an install it using the appropriate Fabric process: in Fabric v2, you will need to package, install, approve, and commit this module on the selected channels in your network.</p>
<h3 id="for-data-sharing-or-asset-transfer">For Data Sharing or Asset Transfer<a class="headerlink" href="#for-data-sharing-or-asset-transfer" title="Permanent link">¶</a></h3>
<p>Both the data sharing and asset transfer modes require the Fabric Interoperation Chaincode, relays, drivers, and IIN agents, to be deployed.</p>
<h4 id="install-the-fabric-interoperation-chaincode_1">Install the Fabric Interoperation Chaincode<a class="headerlink" href="#install-the-fabric-interoperation-chaincode_1" title="Permanent link">¶</a></h4>
<p>Install the Fabric Interoperation Chaincode in the relevant channel(s), i.e., those that run chaincodess that will be involved in data sharing (and asset transfers, which require multiple data shares). This is a Go module that can be fetched from <code>github.com/hyperledger/cacti/weaver/core/network/fabric-interop-cc/contracts/interop</code>. Following that, you an install it using the appropriate Fabric process: in Fabric v2, you will need to package, install, approve, and commit this module on the selected channels in your network.</p>
<h4 id="launch-relay">Launch Relay<a class="headerlink" href="#launch-relay" title="Permanent link">¶</a></h4>
<p>You need to run one or more relays for network-to-network communication. Here we provide instructions to run one relay running in a Docker container, which is sufficient for data sharing. (Later, we will provide instructions to run multiple relays, which will be useful from a failover perspective.)</p>
<p>Weaver provides a <a href="https://github.com/hyperledger-cacti/cacti/pkgs/container/cacti-weaver-relay-server">pre-built image</a> for the relay. Before launching a container, you just need to customize its configuration for your Fabric network, which you can do by simply creating a folder (let's call it <code>relay_config</code>) and configuring the following files in it:</p>
<ul>
<li>
<p><code>.env</code>: This sets suitable environment variables within the relay container. Copy the <code>.env.template</code> file <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/core/relay/.env.template">from the repository</a> and customize it for your purposes, as indicated in the below sample:
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-25-1" id="__codelineno-25-1" name="__codelineno-25-1"></a>PATH_TO_CONFIG=./config.toml
<a href="#__codelineno-25-2" id="__codelineno-25-2" name="__codelineno-25-2"></a>RELAY_NAME=&lt;"name" in config.toml&gt;
<a href="#__codelineno-25-3" id="__codelineno-25-3" name="__codelineno-25-3"></a>RELAY_PORT=&lt;relay-server-port/"port" in config.toml&gt;
<a href="#__codelineno-25-4" id="__codelineno-25-4" name="__codelineno-25-4"></a>EXTERNAL_NETWORK=&lt;docker-bridge-network&gt;
<a href="#__codelineno-25-5" id="__codelineno-25-5" name="__codelineno-25-5"></a>DOCKER_IMAGE_NAME=ghcr.io/hyperledger/cacti-weaver-relay-server
<a href="#__codelineno-25-6" id="__codelineno-25-6" name="__codelineno-25-6"></a>DOCKER_TAG=2.0.0
</code></pre></div></p>
<ul>
<li>The <code>PATH_TO_CONFIG</code> variable should point to the properties file typically named <code>config.toml</code> (you can name this whatever you wish). See further below for instructions to write this file.</li>
<li>The <code>RELAY_NAME</code> variable specifies a unique name for this relay. It should match what's specified in the <code>config.toml</code> (more on that below).</li>
<li>The <code>RELAY_PORT</code> variable specifies the port this relay server will listen on. It should match what's specified in the <code>config.toml</code> (more on that below).</li>
<li>The <code>EXTERNAL_NETWORK</code> variable should be set to the <a href="https://docs.docker.com/compose/networking/">name</a> of your Fabric network.</li>
<li>The <code>DOCKER_*</code> variables are used to specify the image on which the container will be built. Make sure you set <code>DOCKER_TAG</code> to the latest version you see on <a href="ility/pkgs/container/weaver-relay-server">GitHub</a>.</li>
</ul>
<p>For more details, see the <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/core/relay/relay-docker.md">Relay Docker README</a> ("Relay Server Image" and "Running With Docker Compose" sections).</p>
</li>
<li>
<p><code>config.toml</code>: This is the file specified in the <code>PATH_TO_CONFIG</code> variable in the <code>.env</code>. It specifies properties of this relay and the driver(s) it supports. A sample is given below:
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-26-1" id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="n">name</span><span class="o">=</span><span class="err">&lt;relay-name&gt;</span>
<a href="#__codelineno-26-2" id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="n">port</span><span class="o">=</span><span class="err">&lt;relay-port&gt;</span>
<a href="#__codelineno-26-3" id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="n">host</span><span class="o">=</span><span class="s2">"0.0.0.0"</span>
<a href="#__codelineno-26-4" id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="n">db_path</span><span class="o">=</span><span class="s2">"db/&lt;relay-name&gt;/requests"</span>
<a href="#__codelineno-26-5" id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="n">remote_db_path</span><span class="o">=</span><span class="s2">"db/&lt;relay-name&gt;/remote_request"</span>
<a href="#__codelineno-26-6" id="__codelineno-26-6" name="__codelineno-26-6"></a>
<a href="#__codelineno-26-7" id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="c1"># FOR TLS</span>
<a href="#__codelineno-26-8" id="__codelineno-26-8" name="__codelineno-26-8"></a><span class="n">cert_path</span><span class="o">=</span><span class="s2">"credentials/fabric_cert.pem"</span>
<a href="#__codelineno-26-9" id="__codelineno-26-9" name="__codelineno-26-9"></a><span class="n">key_path</span><span class="o">=</span><span class="s2">"credentials/fabric_key"</span>
<a href="#__codelineno-26-10" id="__codelineno-26-10" name="__codelineno-26-10"></a><span class="n">tls</span><span class="o">=</span><span class="err">&lt;</span><span class="kc">true</span><span class="err">/</span><span class="n">false</span><span class="err">&gt;</span>
<a href="#__codelineno-26-11" id="__codelineno-26-11" name="__codelineno-26-11"></a>
<a href="#__codelineno-26-12" id="__codelineno-26-12" name="__codelineno-26-12"></a><span class="k">[networks]</span>
<a href="#__codelineno-26-13" id="__codelineno-26-13" name="__codelineno-26-13"></a><span class="k">[networks.</span><span class="err">&lt;</span><span class="k">network-name</span><span class="err">&gt;</span><span class="k">]</span>
<a href="#__codelineno-26-14" id="__codelineno-26-14" name="__codelineno-26-14"></a><span class="n">network</span><span class="o">=</span><span class="s2">"&lt;driver-name&gt;"</span>
<a href="#__codelineno-26-15" id="__codelineno-26-15" name="__codelineno-26-15"></a>
<a href="#__codelineno-26-16" id="__codelineno-26-16" name="__codelineno-26-16"></a><span class="k">[relays]</span>
<a href="#__codelineno-26-17" id="__codelineno-26-17" name="__codelineno-26-17"></a><span class="k">[relays.</span><span class="err">&lt;</span><span class="k">foreign-relay-name</span><span class="err">&gt;</span><span class="k">]</span>
<a href="#__codelineno-26-18" id="__codelineno-26-18" name="__codelineno-26-18"></a><span class="n">hostname</span><span class="o">=</span><span class="s2">"&lt;foreign-relay-hostname-or-ip-address&gt;"</span>
<a href="#__codelineno-26-19" id="__codelineno-26-19" name="__codelineno-26-19"></a><span class="n">port</span><span class="o">=</span><span class="s2">"&lt;foreign-relay-port&gt;"</span>
<a href="#__codelineno-26-20" id="__codelineno-26-20" name="__codelineno-26-20"></a>
<a href="#__codelineno-26-21" id="__codelineno-26-21" name="__codelineno-26-21"></a><span class="k">[drivers]</span>
<a href="#__codelineno-26-22" id="__codelineno-26-22" name="__codelineno-26-22"></a><span class="k">[drivers.</span><span class="err">&lt;</span><span class="k">driver-name</span><span class="err">&gt;</span><span class="k">]</span>
<a href="#__codelineno-26-23" id="__codelineno-26-23" name="__codelineno-26-23"></a><span class="n">hostname</span><span class="o">=</span><span class="s2">"&lt;driver-hostname-or-ip-address&gt;"</span>
<a href="#__codelineno-26-24" id="__codelineno-26-24" name="__codelineno-26-24"></a><span class="n">port</span><span class="o">=</span><span class="s2">"&lt;driver-port&gt;"</span>
</code></pre></div></p>
<ul>
<li><code>&lt;relay-name&gt;</code> should be a unique ID representing this relay; e.g., <code>my_network_relay</code>. It should match the <code>RELAY_NAME</code> value in <code>.env</code>.</li>
<li><code>&lt;relay-port&gt;</code> is the port number the relay server will listen on. It should match the <code>RELAY_PORT</code> value in <code>.env</code>.</li>
<li><code>db_path</code> and <code>remote_db_path</code> are used internally by the relay to store data. Replace <code>&lt;relay-name&gt;</code> with the same value set for the <code>name</code> parameter. (These can point to any filesystem paths in the relay's container.)</li>
<li>If you set <code>tls</code> to <code>true</code>, the relay will enforce TLS communication. The <code>cert_path</code> and <code>key_path</code> should point to a Fabric TLS certificate and key respectively, such as those created using the <code>cryptogen</code> tool.</li>
<li><code>&lt;network-name&gt;</code> is a unique identifier for your local network. You can set it to whatever value you wish.</li>
<li><code>&lt;driver-name&gt;</code> refers to the driver used by this relay to respond to requests. This also refers to one of the drivers's specifications in the <code>drivers</code> section further below. In this code snippet, we have defined one driver. (The names in lines 14 and 22 must match.) In lines 23 and 24 respectively, you should specify the hostname and port for the driver (whose configuration we will handle later).</li>
<li>The <code>relays</code> section specifies all foreign relays this relay can connect to. The <code>&lt;foreign-relay-name&gt;</code> value should be a unique ID for a given foreign relay, and this value will be used by your Layer-2 applications when constructing view addresses for data sharing requests. In lines 18 and 19, you should specify the hostname and port for the foreign relay.</li>
<li><strong>Enabling TLS</strong>:<ul>
<li>You can make your relay accept TLS connections by specifying a TLS certificate file path and private key file path in <code>cert_path</code> and <code>key_path</code> respectively, and set <code>tls</code> to <code>true</code>.</li>
<li>To communicate with a foreign relay using TLS, specify that relay's TLS CA certificate path in <code>tlsca_cert_path</code> (currently only one certificate can be configured) and set <code>tls</code> to <code>true</code> by extending that relay's section as follows (<em>Note</em>: this CA certificate should match the one specified in the <code>cert_path</code> property in the foreign relay's <code>config.toml</code> file):
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-27-1" id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="k">[relays]</span>
<a href="#__codelineno-27-2" id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="k">[relays.</span><span class="err">&lt;</span><span class="k">foreign-relay-name</span><span class="err">&gt;</span><span class="k">]</span>
<a href="#__codelineno-27-3" id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="n">hostname</span><span class="o">=</span><span class="s2">"&lt;foreign-relay-hostname-or-ip-address&gt;"</span>
<a href="#__codelineno-27-4" id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="n">port</span><span class="o">=</span><span class="s2">"&lt;foreign-relay-port&gt;"</span>
<a href="#__codelineno-27-5" id="__codelineno-27-5" name="__codelineno-27-5"></a><span class="n">tls</span><span class="o">=</span><span class="err">&lt;</span><span class="kc">true</span><span class="err">|</span><span class="n">false</span><span class="err">&gt;</span>
<a href="#__codelineno-27-6" id="__codelineno-27-6" name="__codelineno-27-6"></a><span class="n">tlsca_cert_path</span><span class="o">=</span><span class="s2">"&lt;relay-tls-ca-certificate-path&gt;"</span>
</code></pre></div></li>
<li>To communicate with a driver using TLS, specify the driver's TLS CA certificate in <code>tlsca_cert_path</code> (currently only one certificate can be configured) and set <code>tls</code> to <code>true</code> by extending that driver's section as follows (<em>Note</em>: this CA certificate must match the certificate used by the driver using the <code>DRIVER_TLS_CERT_PATH</code> property in its <code>.env</code> configuration file, which we will examine later):
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-28-1" id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="k">[drivers]</span>
<a href="#__codelineno-28-2" id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="k">[drivers.</span><span class="err">&lt;</span><span class="k">driver-name</span><span class="err">&gt;</span><span class="k">]</span>
<a href="#__codelineno-28-3" id="__codelineno-28-3" name="__codelineno-28-3"></a><span class="n">hostname</span><span class="o">=</span><span class="s2">"&lt;driver-hostname-or-ip-address&gt;"</span>
<a href="#__codelineno-28-4" id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="n">port</span><span class="o">=</span><span class="s2">"&lt;driver-port&gt;"</span>
<a href="#__codelineno-28-5" id="__codelineno-28-5" name="__codelineno-28-5"></a><span class="n">tls</span><span class="o">=</span><span class="err">&lt;</span><span class="kc">true</span><span class="err">|</span><span class="n">false</span><span class="err">&gt;</span>
<a href="#__codelineno-28-6" id="__codelineno-28-6" name="__codelineno-28-6"></a><span class="n">tlsca_cert_path</span><span class="o">=</span><span class="s2">"&lt;driver-tls-ca-certificate-path&gt;"</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">You can specify more than one foreign relay instance in the <code>relays</code> section.</td>
</tr>
<tr>
<td style="text-align: left;">You can specify more than one driver instance in the <code>drivers</code> section.</td>
</tr>
</tbody>
</table>
<ul>
<li><code>docker-compose.yaml</code>: This specifies the properties of the relay container. You can use the <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/core/relay/docker-compose.yaml">file in the repository</a> verbatim.</li>
</ul>
<p>To start the relay server, navigate to the folder containing the above files and run the following:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-29-1" id="__codelineno-29-1" name="__codelineno-29-1"></a>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d<span class="w"> </span>relay-server
</code></pre></div></p>
<h4 id="launch-driver">Launch Driver<a class="headerlink" href="#launch-driver" title="Permanent link">¶</a></h4>
<p>You need to run one or more drivers through which your relay can interact with your Fabric network. Here we provide instructions to run one Fabric driver running in a Docker container, which is sufficient for data sharing. (Later, we will provide instructions to run multiple drivers, which will be useful both from a failover perspective and to interact with different subsets of your Fabric network, like private data collections.)</p>
<p>Weaver provides a <a href="https://github.com/hyperledger-cacti/cacti/pkgs/container/cacti-weaver-driver-fabric">pre-built image</a> for the Fabric driver. Before launching a container, you just need to customize its configuration for your Fabric network, which you can do by simply creating a folder (let's call it <code>driver_config</code>) and configuring the following files in it:</p>
<ul>
<li>
<p><code>.env</code>: This sets suitable environment variables within the driver container. Copy the <code>.env.docker.template</code> file <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/core/drivers/fabric-driver/.env.docker.template">from the repository</a> and customize it for your purposes, as indicated in the below sample:
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-30-1" id="__codelineno-30-1" name="__codelineno-30-1"></a>CONNECTION_PROFILE=&lt;path_to_connection_profile&gt;
<a href="#__codelineno-30-2" id="__codelineno-30-2" name="__codelineno-30-2"></a>DRIVER_CONFIG=./config.json
<a href="#__codelineno-30-3" id="__codelineno-30-3" name="__codelineno-30-3"></a>RELAY_ENDPOINT=&lt;relay-hostname&gt;:&lt;relay-port&gt;
<a href="#__codelineno-30-4" id="__codelineno-30-4" name="__codelineno-30-4"></a>NETWORK_NAME=&lt;network-name&gt;
<a href="#__codelineno-30-5" id="__codelineno-30-5" name="__codelineno-30-5"></a>DRIVER_PORT=&lt;driver-server-port&gt;
<a href="#__codelineno-30-6" id="__codelineno-30-6" name="__codelineno-30-6"></a>INTEROP_CHAINCODE=&lt;interop-chaincode-name&gt;
<a href="#__codelineno-30-7" id="__codelineno-30-7" name="__codelineno-30-7"></a>EXTERNAL_NETWORK=&lt;docker-bridge-network&gt;
<a href="#__codelineno-30-8" id="__codelineno-30-8" name="__codelineno-30-8"></a>TLS_CREDENTIALS_DIR=&lt;dir-with-tls-cert-and-key&gt;
<a href="#__codelineno-30-9" id="__codelineno-30-9" name="__codelineno-30-9"></a>DOCKER_IMAGE_NAME=ghcr.io/hyperledger/cacti-weaver-driver-fabric
<a href="#__codelineno-30-10" id="__codelineno-30-10" name="__codelineno-30-10"></a>DOCKER_TAG=2.0.0
<a href="#__codelineno-30-11" id="__codelineno-30-11" name="__codelineno-30-11"></a>DRIVER_TLS=&lt;true|false&gt;
<a href="#__codelineno-30-12" id="__codelineno-30-12" name="__codelineno-30-12"></a>DRIVER_TLS_CERT_PATH=path_to_tls_cert_pem_for_driver
<a href="#__codelineno-30-13" id="__codelineno-30-13" name="__codelineno-30-13"></a>DRIVER_TLS_KEY_PATH=path_to_tls_key_pem_for_driver
<a href="#__codelineno-30-14" id="__codelineno-30-14" name="__codelineno-30-14"></a>RELAY_TLS=&lt;true|false&gt;
<a href="#__codelineno-30-15" id="__codelineno-30-15" name="__codelineno-30-15"></a>RELAY_TLSCA_CERT_PATH=path_to_tls_ca_cert_pem_for_relay
</code></pre></div></p>
<ul>
<li><code>&lt;path_to_connection_profile&gt;</code> should point to the path of a connection profile you generated in the "Pre-Configuration" section. A Fabric driver obtains client credentials from one of the organizations in your network, so pick an organization and point to the right connection profile.</li>
<li>The <code>DRIVER_CONFIG</code> variable should point to the <code>config.json</code> (you can name this whatever you wish) specified below.</li>
<li><code>&lt;relay-hostname&gt;</code> should be set to the hostname of the relay server machine and <code>&lt;relay-port&gt;</code> should match the <code>port</code> value in the relay's <code>config.toml</code> (see above).</li>
<li>The <code>NETWORK_NAME</code> variable should be a unique ID referring to the Fabric network. It will be used to distinguish container names and wallet paths. (This setting is relevant in situations where a driver is used to query multiple network channels.)</li>
<li>The <code>DRIVER_PORT</code> variable should be set to the port this driver will listen on.</li>
<li>The <code>INTEROP_CHAINCODE</code> variable should be set to the ID of the Fabric Interop Chaincode installed on your Fabric network channel.</li>
<li>The <code>EXTERNAL_NETWORK</code> variable should be set to the <a href="https://docs.docker.com/compose/networking/">name</a> of your Fabric network.</li>
<li><strong>Enabling TLS</strong>:<ul>
<li>You can make your driver accept TLS connections by specifying <code>DRIVER_TLS</code> as <code>true</code> and specifying a TLS certificate file path and private key file path in <code>DRIVER_TLS_CERT_PATH</code> and <code>DRIVER_TLS_KEY_PATH</code> respectively. The same certificate should be specified in this driver's definition in the <code>drivers</code> section in the <code>config.toml</code> file of your relay in the <code>tlsca_cert_path</code> property (see the earlier section on relay configuration).</li>
<li>To communicate with your network' relay using TLS (i.e., if the relay is TLS-enabled), specify that relay's TLS CA certificate path in <code>RELAY_TLSCA_CERT_PATH</code> (currently only one certificate can be configured) and set <code>RELAY_TLS</code> to <code>true</code>. This CA certificate should match the one specified in the <code>cert_path</code> property in the relay's <code>config.toml</code> file (see the earlier section on relay configuration):</li>
<li>You can point to the folder in your host system containing the certificate and key using the <code>TLS_CREDENTIALS_DIR</code> variable. (This folder will be synced to the <code>/fabric-driver/credentials</code> folder in the Fabric Driver container as specified in the <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/core/drivers/fabric-driver/docker-compose.yml">docker compose file</a>.) Make sure you point to the right certificate and key file paths within the container using the <code>DRIVER_TLS_CERT_PATH</code>, <code>DRIVER_TLS_KEY_PATH</code>, and <code>RELAY_TLSCA_CERT_PATH</code> variables.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>config.json</code>: This contains settings used to connect to a CA of a Fabric network organization and enroll a client. A sample is given below:
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-31-1" id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="p">{</span>
<a href="#__codelineno-31-2" id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="w">    </span><span class="nt">"admin"</span><span class="p">:{</span>
<a href="#__codelineno-31-3" id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="w">        </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"admin"</span><span class="p">,</span>
<a href="#__codelineno-31-4" id="__codelineno-31-4" name="__codelineno-31-4"></a><span class="w">        </span><span class="nt">"secret"</span><span class="p">:</span><span class="s2">"adminpw"</span>
<a href="#__codelineno-31-5" id="__codelineno-31-5" name="__codelineno-31-5"></a><span class="w">    </span><span class="p">},</span>
<a href="#__codelineno-31-6" id="__codelineno-31-6" name="__codelineno-31-6"></a><span class="w">    </span><span class="nt">"relay"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-31-7" id="__codelineno-31-7" name="__codelineno-31-7"></a><span class="w">        </span><span class="nt">"name"</span><span class="p">:</span><span class="s2">"relay"</span><span class="p">,</span>
<a href="#__codelineno-31-8" id="__codelineno-31-8" name="__codelineno-31-8"></a><span class="w">        </span><span class="nt">"affiliation"</span><span class="p">:</span><span class="s2">"&lt;affiliation&gt;"</span><span class="p">,</span>
<a href="#__codelineno-31-9" id="__codelineno-31-9" name="__codelineno-31-9"></a><span class="w">        </span><span class="nt">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client"</span><span class="p">,</span>
<a href="#__codelineno-31-10" id="__codelineno-31-10" name="__codelineno-31-10"></a><span class="w">        </span><span class="nt">"attrs"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"relay"</span><span class="p">,</span><span class="w"> </span><span class="nt">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"true"</span><span class="p">,</span><span class="w"> </span><span class="nt">"ecert"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}]</span>
<a href="#__codelineno-31-11" id="__codelineno-31-11" name="__codelineno-31-11"></a><span class="w">    </span><span class="p">},</span>
<a href="#__codelineno-31-12" id="__codelineno-31-12" name="__codelineno-31-12"></a><span class="w">    </span><span class="nt">"mspId"</span><span class="p">:</span><span class="s2">"&lt;msp-id&gt;"</span><span class="p">,</span>
<a href="#__codelineno-31-13" id="__codelineno-31-13" name="__codelineno-31-13"></a><span class="w">    </span><span class="nt">"caUrl"</span><span class="p">:</span><span class="s2">"&lt;ca-service-endpoint&gt;"</span>
<a href="#__codelineno-31-14" id="__codelineno-31-14" name="__codelineno-31-14"></a><span class="p">}</span>
</code></pre></div></p>
<ul>
<li>As in the <code>.env</code> configuration, you should pick an organization for the driver to associate with. The <code>admin</code> section specifies the registrar name and password (this should be familiar to any Fabric network administrator) used to enroll clients. Default values of <code>admin</code> and <code>adminpw</code> are specified above as examples, which you should replace with the right values configured in your network organization's CA.</li>
<li><code>&lt;affiliation&gt;</code> should be what's specified in your organization's Fabric CA server configuration. The default is <code>org1.department1</code>, but you should look up the appropriate value from the CA server's configuration file.</li>
<li><code>&lt;msp-id&gt;</code> should be set to the (or an) MSP ID of the selected organization.</li>
<li><code>&lt;ca-service-endpoint&gt;</code> should be set to the CA server's endpoint. If you launched your CA server as a container from a docker compose file, this should be set to the container's service name.</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">If your connection profile already contains specifications for a CA server, you can leave the <code>&lt;ca-service-endpoint&gt;</code> value as a blank.</td>
</tr>
</tbody>
</table>
<ul>
<li><code>docker-compose.yaml</code>: This specifies the properties of the driver container. You can use the <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/core/drivers/fabric-driver/docker-compose.yml">file in the repository</a> verbatim.</li>
</ul>
<p>To start the driver, navigate to the folder containing the above files and run the following:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-32-1" id="__codelineno-32-1" name="__codelineno-32-1"></a>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div></p>
<h4 id="launch-iin-agents">Launch IIN Agents<a class="headerlink" href="#launch-iin-agents" title="Permanent link">¶</a></h4>
<p>You need to run one IIN Agent for each organization in the Fabric network channel you are enabling Weaver in. This agent runs a protocol with other organizations' agents and with targeted foreign networks' agents to sync and record foreign networks' memberships to the channel ledger.</p>
<p>Weaver provides a <a href="https://github.com/hyperledger-cacti/cacti/pkgs/container/cacti-weaver-iin-agent">pre-built image</a> for the IIN Agent. Before launching a container, you just need to customize its configuration for your Fabric network organization, which you can do by simply creating a folder (let's call it <code>iin_agent_config_&lt;orgname&gt;</code>) and configuring the following files in it:</p>
<ul>
<li>
<p><code>config.json</code>: This contains settings used to connect to a Fabric network organization and its CA (part of the organization's MSP). A sample is given below:
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-33-1" id="__codelineno-33-1" name="__codelineno-33-1"></a>{
<a href="#__codelineno-33-2" id="__codelineno-33-2" name="__codelineno-33-2"></a>    "admin":{
<a href="#__codelineno-33-3" id="__codelineno-33-3" name="__codelineno-33-3"></a>        "name":"admin",
<a href="#__codelineno-33-4" id="__codelineno-33-4" name="__codelineno-33-4"></a>        "secret":"adminpw"
<a href="#__codelineno-33-5" id="__codelineno-33-5" name="__codelineno-33-5"></a>    },
<a href="#__codelineno-33-6" id="__codelineno-33-6" name="__codelineno-33-6"></a>    "agent": {
<a href="#__codelineno-33-7" id="__codelineno-33-7" name="__codelineno-33-7"></a>        "name":"iin-agent",
<a href="#__codelineno-33-8" id="__codelineno-33-8" name="__codelineno-33-8"></a>        "affiliation":"&lt;affiliation&gt;",
<a href="#__codelineno-33-9" id="__codelineno-33-9" name="__codelineno-33-9"></a>        "role": "client",
<a href="#__codelineno-33-10" id="__codelineno-33-10" name="__codelineno-33-10"></a>        "attrs": [{ "name": "iin-agent", "value": "true", "ecert": true }]
<a href="#__codelineno-33-11" id="__codelineno-33-11" name="__codelineno-33-11"></a>    },
<a href="#__codelineno-33-12" id="__codelineno-33-12" name="__codelineno-33-12"></a>    "mspId":"&lt;msp-id&gt;",
<a href="#__codelineno-33-13" id="__codelineno-33-13" name="__codelineno-33-13"></a>    "ordererMspIds": [&lt;list-of-orderer-msp-ids&gt;],
<a href="#__codelineno-33-14" id="__codelineno-33-14" name="__codelineno-33-14"></a>    "ccpPath": "&lt;path-to-connection-profile&gt;",
<a href="#__codelineno-33-15" id="__codelineno-33-15" name="__codelineno-33-15"></a>    "walletPath": "",
<a href="#__codelineno-33-16" id="__codelineno-33-16" name="__codelineno-33-16"></a>    "caUrl": "&lt;ca-service-endpoint&gt;",
<a href="#__codelineno-33-17" id="__codelineno-33-17" name="__codelineno-33-17"></a>    "local": "false"
<a href="#__codelineno-33-18" id="__codelineno-33-18" name="__codelineno-33-18"></a>}
</code></pre></div></p>
</li>
<li>
<p><code>dnsconfig.json</code>: This specifies the list of known IIN agents of your network (i.e., belonging to other organizations) and of foreign networks. A sample DNS configuration file is given below:
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-34-1" id="__codelineno-34-1" name="__codelineno-34-1"></a>{
<a href="#__codelineno-34-2" id="__codelineno-34-2" name="__codelineno-34-2"></a>    "&lt;securityDomainName1&gt;": {
<a href="#__codelineno-34-3" id="__codelineno-34-3" name="__codelineno-34-3"></a>        "&lt;iin-agent1-name&gt;": {
<a href="#__codelineno-34-4" id="__codelineno-34-4" name="__codelineno-34-4"></a>            "endpoint": "&lt;hostname:port&gt;",
<a href="#__codelineno-34-5" id="__codelineno-34-5" name="__codelineno-34-5"></a>            "tls": &lt;true/false&gt;,
<a href="#__codelineno-34-6" id="__codelineno-34-6" name="__codelineno-34-6"></a>            "tlsCACertPath": "&lt;cacert-path-or-empty-string&gt;"
<a href="#__codelineno-34-7" id="__codelineno-34-7" name="__codelineno-34-7"></a>        },
<a href="#__codelineno-34-8" id="__codelineno-34-8" name="__codelineno-34-8"></a>        "&lt;iin-agent2-name&gt;": {
<a href="#__codelineno-34-9" id="__codelineno-34-9" name="__codelineno-34-9"></a>            "endpoint": "&lt;hostname:port&gt;",
<a href="#__codelineno-34-10" id="__codelineno-34-10" name="__codelineno-34-10"></a>            "tls": &lt;true/false&gt;,
<a href="#__codelineno-34-11" id="__codelineno-34-11" name="__codelineno-34-11"></a>            "tlsCACertPath": "&lt;cacert-path-or-empty-string&gt;"
<a href="#__codelineno-34-12" id="__codelineno-34-12" name="__codelineno-34-12"></a>        }
<a href="#__codelineno-34-13" id="__codelineno-34-13" name="__codelineno-34-13"></a>    },
<a href="#__codelineno-34-14" id="__codelineno-34-14" name="__codelineno-34-14"></a>    "&lt;securityDomainName2&gt;": {
<a href="#__codelineno-34-15" id="__codelineno-34-15" name="__codelineno-34-15"></a>        "&lt;iin-agent1-name&gt;": {
<a href="#__codelineno-34-16" id="__codelineno-34-16" name="__codelineno-34-16"></a>            "endpoint": "&lt;hostname:port&gt;",
<a href="#__codelineno-34-17" id="__codelineno-34-17" name="__codelineno-34-17"></a>            "tls": &lt;true/false&gt;,
<a href="#__codelineno-34-18" id="__codelineno-34-18" name="__codelineno-34-18"></a>            "tlsCACertPath": "&lt;cacert-path-or-empty-string&gt;"
<a href="#__codelineno-34-19" id="__codelineno-34-19" name="__codelineno-34-19"></a>        },
<a href="#__codelineno-34-20" id="__codelineno-34-20" name="__codelineno-34-20"></a>        "&lt;iin-agent2-name&gt;": {
<a href="#__codelineno-34-21" id="__codelineno-34-21" name="__codelineno-34-21"></a>            "endpoint": "&lt;hostname:port&gt;",
<a href="#__codelineno-34-22" id="__codelineno-34-22" name="__codelineno-34-22"></a>            "tls": &lt;true/false&gt;,
<a href="#__codelineno-34-23" id="__codelineno-34-23" name="__codelineno-34-23"></a>            "tlsCACertPath": "&lt;cacert-path-or-empty-string&gt;"
<a href="#__codelineno-34-24" id="__codelineno-34-24" name="__codelineno-34-24"></a>        }
<a href="#__codelineno-34-25" id="__codelineno-34-25" name="__codelineno-34-25"></a>    }
<a href="#__codelineno-34-26" id="__codelineno-34-26" name="__codelineno-34-26"></a>}
</code></pre></div></p>
<ul>
<li>Each security domain (i.e., unique ledger, like a Fabric channel) scopes a set of JSON objects, each containing specifications of an IIN Agent. The key (<code>&lt;iin-agent1-name&gt;</code> for example) in each is the IIN Agent's name, which can be the organization's MSP ID (for a Fabric network). The value is another JSON object, containing an <code>endpoint</code> with a hostname and port for the agent.</li>
<li><strong>Enabling TLS</strong>: To communicate with a given IIN Agent using TLS (i.e., if that agent is TLS-enabled), specify <code>tls</code> as <code>true</code> and that agent's TLS CA certificate path in <code>tlsCACertPath</code> (currently only one certificate can be configured) within the JSON object corresponding to that agent. This CA certificate should match the one specified in that IIN Agent's <code>.env</code> file, whose configuration we will specify later.</li>
</ul>
</li>
<li>
<p><code>security-domain-config.json</code>: This config file contains list of security domain defined for the network and its members, i.e. it can be list of organizations or channel name. Sample security domain configuration file:
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-35-1" id="__codelineno-35-1" name="__codelineno-35-1"></a>{
<a href="#__codelineno-35-2" id="__codelineno-35-2" name="__codelineno-35-2"></a>    "&lt;securityDomainName1&gt;": "&lt;channelName&gt;",
<a href="#__codelineno-35-3" id="__codelineno-35-3" name="__codelineno-35-3"></a>    "&lt;securityDomainName2&gt;": [
<a href="#__codelineno-35-4" id="__codelineno-35-4" name="__codelineno-35-4"></a>        "&lt;Org1MSPId&gt;",
<a href="#__codelineno-35-5" id="__codelineno-35-5" name="__codelineno-35-5"></a>        "&lt;Org2MSPId&gt;"
<a href="#__codelineno-35-6" id="__codelineno-35-6" name="__codelineno-35-6"></a>    ]
<a href="#__codelineno-35-7" id="__codelineno-35-7" name="__codelineno-35-7"></a>}
</code></pre></div></p>
</li>
<li>
<p><code>.env</code>: This sets suitable environment variables within the driver container. Copy the <code>.env.template</code> file <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/core/identity-management/iin-agent/.env.docker.template">from the repository</a> and customize it for your purposes, as indicated in the below sample:
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-36-1" id="__codelineno-36-1" name="__codelineno-36-1"></a>IIN_AGENT_PORT=&lt;iin-agent-server-port&gt;
<a href="#__codelineno-36-2" id="__codelineno-36-2" name="__codelineno-36-2"></a>IIN_AGENT_TLS=&lt;true/false&gt;
<a href="#__codelineno-36-3" id="__codelineno-36-3" name="__codelineno-36-3"></a>IIN_AGENT_TLS_CERT_PATH=&lt;path_to_tls_cert_pem_for_iin_agent&gt;
<a href="#__codelineno-36-4" id="__codelineno-36-4" name="__codelineno-36-4"></a>IIN_AGENT_TLS_KEY_PATH=&lt;path_to_tls_key_pem_for_iin_agent&gt;
<a href="#__codelineno-36-5" id="__codelineno-36-5" name="__codelineno-36-5"></a>MEMBER_ID=&lt;org-msp-id&gt;
<a href="#__codelineno-36-6" id="__codelineno-36-6" name="__codelineno-36-6"></a>SECURITY_DOMAIN=network1
<a href="#__codelineno-36-7" id="__codelineno-36-7" name="__codelineno-36-7"></a>DLT_TYPE=fabric
<a href="#__codelineno-36-8" id="__codelineno-36-8" name="__codelineno-36-8"></a>CONFIG_PATH=./config.json
<a href="#__codelineno-36-9" id="__codelineno-36-9" name="__codelineno-36-9"></a>DNS_CONFIG_PATH=./dnsconfig.json
<a href="#__codelineno-36-10" id="__codelineno-36-10" name="__codelineno-36-10"></a>SECURITY_DOMAIN_CONFIG_PATH=./security-domain-config.json
<a href="#__codelineno-36-11" id="__codelineno-36-11" name="__codelineno-36-11"></a>WEAVER_CONTRACT_ID=&lt;name-of-weaver-interop-chaincode-installed&gt;
<a href="#__codelineno-36-12" id="__codelineno-36-12" name="__codelineno-36-12"></a>SYNC_PERIOD=&lt;repeated_auto_sync_interval&gt;
<a href="#__codelineno-36-13" id="__codelineno-36-13" name="__codelineno-36-13"></a>AUTO_SYNC=&lt;true/false&gt;
<a href="#__codelineno-36-14" id="__codelineno-36-14" name="__codelineno-36-14"></a>TLS_CREDENTIALS_DIR=&lt;dir-with-tls-cert-and-key&gt;
<a href="#__codelineno-36-15" id="__codelineno-36-15" name="__codelineno-36-15"></a>DOCKER_IMAGE_NAME=ghcr.io/hyperledger/cacti-weaver-iin-agent
<a href="#__codelineno-36-16" id="__codelineno-36-16" name="__codelineno-36-16"></a>DOCKER_TAG=&lt;iin-agent-docker-image-version&gt;
<a href="#__codelineno-36-17" id="__codelineno-36-17" name="__codelineno-36-17"></a>EXTERNAL_NETWORK=&lt;docker-bridge-network&gt;
</code></pre></div></p>
<ul>
<li><code>IIN_AGENT_ENDPOINT</code>: The endpoint at which IIN Agent server should listen. E.g.: <code>0.0.0.0:9500</code></li>
<li><code>IIN_AGENT_TLS</code>: Set this to <code>true</code> to enable TLS on IIN Agent server</li>
<li><code>IIN_AGENT_TLS_CERT_PATH</code>: Path to TLS certificate if TLS is enabled</li>
<li><code>IIN_AGENT_TLS_KEY_PATH</code>: Path to TLS key if TLS is enabled</li>
<li><code>MEMBER_ID</code>: Member Id for this IIN Agent. For fabric network, it should be the Organization's MSP ID</li>
<li><code>SECURITY_DOMAIN</code>: Security domain to which this IIN Agent belongs</li>
<li><code>DLT_TYPE</code>: To indicate the type of DLT for which this IIN Agent is running. E.g. <code>fabric</code></li>
<li><code>CONFIG_PATH</code>: Path to ledger specific config file (explained in next subsection)</li>
<li><code>DNS_CONFIG_PATH</code>: Path to DNS config file explained in previous sub sections</li>
<li><code>SECURITY_DOMAIN_CONFIG_PATH</code>: Path to security domain config file explained in previous sub sections</li>
<li><code>WEAVER_CONTRACT_ID</code>: Contract ID for DLT specific Weaver interoperation module installed on network</li>
<li><code>SYNC_PERIOD</code>: Period at which auto synchronization of memberships from other security domains should happen</li>
<li><code>AUTO_SYNC</code>: Set this to <code>true</code> to enable auto synchronization of memberships from other security domains</li>
<li><code>DOCKER_TAG</code>: Set this to the desired version of the Weaver IIN Agent <a href="https://github.com/hyperledger-cacti/cacti/pkgs/container/cacti-weaver-iin-agent">docker image</a></li>
<li><code>EXTERNAL_NETWORK</code>: Set to the network <a href="https://docs.docker.com/compose/networking/">name</a> of your Fabric network.</li>
<li><strong>Enabling TLS</strong>:<ul>
<li>Make your IIN Agent accept TLS connections by specifying <code>IIN_AGENT_TLS</code> as <code>true</code> and specifying a TLS certificate file path and private key file path in <code>IIN_AGENT_TLS_CERT_PATH</code> and <code>IIN_AGENT_TLS_KEY_PATH</code> respectively. The same certificate should be specified in this agent's JSON object in another agent's <code>dnsconfig.json</code> file under the appropriate security domain and IIN Agent ID scope.</li>
<li>You can point to the folder in your host system containing the certificate and key using the <code>TLS_CREDENTIALS_DIR</code> variable. (This folder will be synced to the <code>/opt/iinagent/credentials</code> folder in the IIN Agent container as specified in the <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/core/identity-management/iin-agent/docker-compose.yml">docker compose file</a>.) Make sure you point to the right certificate and key file paths within the container using the <code>IIN_AGENT_TLS_CERT_PATH</code> and <code>IIN_AGENT_TLS_KEY_PATH</code> variables respectively.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>docker-compose.yaml</code>: This specifies the properties of the IIN agent container. You can use the <a href="https://github.com/hyperledger-cacti/cacti/blob/main/weaver/core/identity-management/iin-agent/docker-compose.yml">file in the repository</a> verbatim.</p>
</li>
</ul>
<p>Now to start the IIN agent, navigate to the folder containing the above files and run the following:
<div class="highlight"><pre><span></span><code><a href="#__codelineno-37-1" id="__codelineno-37-1" name="__codelineno-37-1"></a>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div></p>
<p>Repeat the above steps to launch an IIN Agent for every other organization on your channnel, i.e., create similar configuration files in an organization-specific folder. Make sure you:</p>
<ul>
<li>Update the organization names in every relevant location in the <code>config.json</code>.</li>
<li>Update <code>IIN_AGENT_ENDPOINT</code> and <code>MEMBER_ID</code> in the <code>.env</code>.</li>
</ul>
<h4 id="ledger-initialization">Ledger Initialization<a class="headerlink" href="#ledger-initialization" title="Permanent link">¶</a></h4>
<p>To prepare your network for interoperation with a foreign network, you need to record the following to your network channel through the Fabric Interoperation Chaincode:</p>
<ul>
<li><strong>Access control policies</strong>:
  Let's take the example of the request made from <code>trade-finance-network</code> to <code>trade-logistics-network</code> for a B/L earlier in this document. <code>trade-logistics-network</code> can have a policy of the following form permitting access to the <code>GetBillOfLading</code> function from a client belonging to the <code>Exporter</code> organization in <code>trade-finance-network</code> as follows:
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-38-1" id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="p">{</span>
<a href="#__codelineno-38-2" id="__codelineno-38-2" name="__codelineno-38-2"></a><span class="w">    </span><span class="nt">"securityDomain"</span><span class="p">:</span><span class="s2">"trade-finance-network"</span><span class="p">,</span>
<a href="#__codelineno-38-3" id="__codelineno-38-3" name="__codelineno-38-3"></a><span class="w">    </span><span class="nt">"rules"</span><span class="p">:</span>
<a href="#__codelineno-38-4" id="__codelineno-38-4" name="__codelineno-38-4"></a><span class="w">        </span><span class="p">[</span>
<a href="#__codelineno-38-5" id="__codelineno-38-5" name="__codelineno-38-5"></a><span class="w">            </span><span class="p">{</span>
<a href="#__codelineno-38-6" id="__codelineno-38-6" name="__codelineno-38-6"></a><span class="w">                </span><span class="nt">"principal"</span><span class="p">:</span><span class="s2">"ExporterMSP"</span><span class="p">,</span>
<a href="#__codelineno-38-7" id="__codelineno-38-7" name="__codelineno-38-7"></a><span class="w">                </span><span class="nt">"principalType"</span><span class="p">:</span><span class="s2">"ca"</span><span class="p">,</span>
<a href="#__codelineno-38-8" id="__codelineno-38-8" name="__codelineno-38-8"></a><span class="w">                </span><span class="nt">"resource"</span><span class="p">:</span><span class="s2">"tradelogisticschannel:shipmentcc:GetBillOfLading:*"</span><span class="p">,</span>
<a href="#__codelineno-38-9" id="__codelineno-38-9" name="__codelineno-38-9"></a><span class="w">                </span><span class="nt">"read"</span><span class="p">:</span><span class="kc">true</span>
<a href="#__codelineno-38-10" id="__codelineno-38-10" name="__codelineno-38-10"></a><span class="w">            </span><span class="p">}</span>
<a href="#__codelineno-38-11" id="__codelineno-38-11" name="__codelineno-38-11"></a><span class="w">        </span><span class="p">]</span>
<a href="#__codelineno-38-12" id="__codelineno-38-12" name="__codelineno-38-12"></a><span class="p">}</span>
</code></pre></div>
  In this sample, a single rule is specified for requests coming from <code>trade-finance-network</code>: it states that a <code>GetBillOfLading</code> query made to the <code>shipmentcc</code> contract installed on the <code>tradelogisticschannel</code> channel is permitted for a requestor possessing credentials certified by an MSP with the <code>ExporterMSP</code> identity. The <code>*</code> at the end indicates that any arguments passed to the function will pass the access control check.</li>
</ul>
<p>You need to record this policy rule on your Fabric network's channel by invoking either the <code>CreateAccessControlPolicy</code> function or the <code>UpdateAccessControlPolicy</code> function on the Fabric Interoperation Chaincode that is already installed on that channel; use the former if you are recording a set of rules for the given <code>securityDomain</code> for the first time and the latter to overwrite a set of rules recorded earlier. In either case, the chaincode function will take a single argument, which is the policy in the form of a JSON string (make sure you escape the double quotes before sending the request to avoid parsing errors). You can do this in one of two ways: (1) writing a small piece of code in Layer-2 that invokes the contract using the Fabric SDK Gateway API, or (2) running a <code>peer chaincode invoke</code> command from within a Docker container built on the <code>hyperledger/fabric-tools</code> image. Either approach should be familiar to a Fabric practitioner.</p>
<ul>
<li><strong>Verification policies</strong>:
  Taking the same example as above, an example of a verification policy for a B/L requested by the <code>trade-finance-network</code> from the <code>trade-logistics-network</code> is as follows:
  <div class="highlight"><pre><span></span><code><a href="#__codelineno-39-1" id="__codelineno-39-1" name="__codelineno-39-1"></a><span class="p">{</span>
<a href="#__codelineno-39-2" id="__codelineno-39-2" name="__codelineno-39-2"></a><span class="w">    </span><span class="nt">"securityDomain"</span><span class="p">:</span><span class="s2">"trade-logistics-network"</span><span class="p">,</span>
<a href="#__codelineno-39-3" id="__codelineno-39-3" name="__codelineno-39-3"></a><span class="w">    </span><span class="nt">"identifiers"</span><span class="p">:</span>
<a href="#__codelineno-39-4" id="__codelineno-39-4" name="__codelineno-39-4"></a><span class="w">        </span><span class="p">[</span>
<a href="#__codelineno-39-5" id="__codelineno-39-5" name="__codelineno-39-5"></a><span class="w">            </span><span class="p">{</span>
<a href="#__codelineno-39-6" id="__codelineno-39-6" name="__codelineno-39-6"></a><span class="w">                </span><span class="nt">"pattern"</span><span class="p">:</span><span class="s2">"tradelogisticschannel:shipmentcc:GetBillOfLading:*"</span><span class="p">,</span>
<a href="#__codelineno-39-7" id="__codelineno-39-7" name="__codelineno-39-7"></a><span class="w">                </span><span class="nt">"policy"</span><span class="p">:</span>
<a href="#__codelineno-39-8" id="__codelineno-39-8" name="__codelineno-39-8"></a><span class="w">                    </span><span class="p">{</span>
<a href="#__codelineno-39-9" id="__codelineno-39-9" name="__codelineno-39-9"></a><span class="w">                        </span><span class="nt">"type"</span><span class="p">:</span><span class="s2">"Signature"</span><span class="p">,</span>
<a href="#__codelineno-39-10" id="__codelineno-39-10" name="__codelineno-39-10"></a><span class="w">                        </span><span class="nt">"criteria"</span><span class="p">:</span>
<a href="#__codelineno-39-11" id="__codelineno-39-11" name="__codelineno-39-11"></a><span class="w">                            </span><span class="p">[</span>
<a href="#__codelineno-39-12" id="__codelineno-39-12" name="__codelineno-39-12"></a><span class="w">                                </span><span class="s2">"ExporterMSP"</span><span class="p">,</span>
<a href="#__codelineno-39-13" id="__codelineno-39-13" name="__codelineno-39-13"></a><span class="w">                                </span><span class="s2">"CarrierMSP"</span>
<a href="#__codelineno-39-14" id="__codelineno-39-14" name="__codelineno-39-14"></a><span class="w">                            </span><span class="p">]</span>
<a href="#__codelineno-39-15" id="__codelineno-39-15" name="__codelineno-39-15"></a><span class="w">                    </span><span class="p">}</span>
<a href="#__codelineno-39-16" id="__codelineno-39-16" name="__codelineno-39-16"></a><span class="w">            </span><span class="p">}</span>
<a href="#__codelineno-39-17" id="__codelineno-39-17" name="__codelineno-39-17"></a><span class="w">        </span><span class="p">]</span>
<a href="#__codelineno-39-18" id="__codelineno-39-18" name="__codelineno-39-18"></a><span class="p">}</span>
</code></pre></div>
  In this sample, a single verification policy rule is specified for data views coming from <code>trade-logistics-network</code>: it states that the data returned by the <code>GetBillOfLading</code> query made to the <code>shipmentcc</code> chaincode on the <code>tradelogisticschannel</code> channel requires as proof two signatures, one from a peer in the organization whose MSP ID is <code>ExporterMSP</code> and another from a peer in the organization whose MSP ID is <code>CarrierMSP</code>.</li>
</ul>
<p>You need to record this policy rule on your Fabric network's channel by invoking either the <code>CreateVerificationPolicy</code> function or the <code>UpdateVerificationPolicy</code> function on the Fabric Interoperation Chaincode that is already installed on that channel; use the former if you are recording a set of rules for the given <code>securityDomain</code> for the first time and the latter to overwrite a set of rules recorded earlier. In either case, the chaincode function will take a single argument, which is the policy in the form of a JSON string (make sure you escape the double quotes before sending the request to avoid parsing errors). As with the access control policy, you can do this in one of two ways: (1) writing a small piece of code in Layer-2 that invokes the contract using the Fabric SDK Gateway API, or (2) running a <code>peer chaincode invoke</code> command from within a Docker container built on the <code>hyperledger/fabric-tools</code> image. Either approach should be familiar to a Fabric practitioner.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">For any cross-network data request, make sure an access control policy is recorded in the <em>source network</em> (<code>trade-logistics-network</code> in the above example) and a corresponding verification policy is recorded in the <em>destination network</em> (<code>trade-finance-network</code> in the above example) before any relay request is triggered.</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Local network security domain (membership) configuration</strong>:
  Recall the code snippet added to your application in the "Identity Administration" section. Exercise that code snippet, exposed either through a function API or an HTTP endpoint, to record the initial local membership for the relevant network channels.</li>
</ul>
<p>Your Fabric network is now up and running with the necessary Weaver components, and your network's channel's ledger is bootstrapped with the initial configuration necessary for cross-network interactions!</p>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Overview" class="md-footer__link md-footer__link--prev" href="../overview/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                Overview
              </div>
</div>
</a>
<a aria-label="Next: R3 Corda" class="md-footer__link md-footer__link--next" href="../corda/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                R3 Corda
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © Hyperledger 2020-2023
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy", "navigation.expand", "navigation.footer", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "toc.follow", "toc.integrate"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
<script src="../../../../assets/javascripts/bundle.83f73b43.min.js"></script>
<script>document$.subscribe(() => {
            window.update_swagger_ui_iframe_height = function (id) {
                var iFrameID = document.getElementById(id);
                if (iFrameID) {
                    full_height = (iFrameID.contentWindow.document.body.scrollHeight + 80) + "px";
                    iFrameID.height = full_height;
                    iFrameID.style.height = full_height;
                }
            }
        
            let iframe_id_list = []
            var iframes = document.getElementsByClassName("swagger-ui-iframe");
            for (var i = 0; i < iframes.length; i++) { 
                iframe_id_list.push(iframes[i].getAttribute("id"))
            }
        
            let ticking = true;
            
            document.addEventListener('scroll', function(e) {
                if (!ticking) {
                    window.requestAnimationFrame(()=> {
                        let half_vh = window.innerHeight/2;
                        for(var i = 0; i < iframe_id_list.length; i++) {
                            let element = document.getElementById(iframe_id_list[i])
                            if(element==null){
                                return
                            }
                            let diff = element.getBoundingClientRect().top
                            if(element.contentWindow.update_top_val){
                                element.contentWindow.update_top_val(half_vh - diff)
                            }
                        }
                        ticking = false;
                    });
                    ticking = true;
                }
            });
        
            const dark_scheme_name = "slate"
            
            window.scheme = document.body.getAttribute("data-md-color-scheme")
            const options = {
                attributeFilter: ['data-md-color-scheme'],
            };
            function color_scheme_callback(mutations) {
                for (let mutation of mutations) {
                    if (mutation.attributeName === "data-md-color-scheme") {
                        scheme = document.body.getAttribute("data-md-color-scheme")
                        var iframe_list = document.getElementsByClassName("swagger-ui-iframe")
                        for(var i = 0; i < iframe_list.length; i++) {
                            var ele = iframe_list.item(i);
                            if (ele) {
                                if (scheme === dark_scheme_name) {
                                    ele.contentWindow.enable_dark_mode();
                                } else {
                                    ele.contentWindow.disable_dark_mode();
                                }
                            }
                        }
                    }
                }
            }
            observer = new MutationObserver(color_scheme_callback);
            observer.observe(document.body, options);
            })</script></body>
</html>