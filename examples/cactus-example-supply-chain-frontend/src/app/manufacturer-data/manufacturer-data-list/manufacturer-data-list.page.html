<app-page-heading pageTitle="Manufacturer Data List"></app-page-heading>

<ion-content>
  <!-- Wallet connection section -->
  <div *ngIf="!isWalletConnected" class="ion-padding">
    <ion-card>
      <ion-card-header>
        <ion-card-title>Wallet Connection Required</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p>
          You need to connect your wallet to view and interact with manufacturer
          data.
        </p>
        <ion-button
          expand="block"
          (click)="connectWallet()"
          [disabled]="isLoading"
        >
          <ion-spinner *ngIf="isLoading" name="dots"></ion-spinner>
          <span *ngIf="!isLoading">Connect Wallet</span>
        </ion-button>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Role information panel -->
  <div *ngIf="isWalletConnected" class="ion-padding">
    <ion-card color="light">
      <ion-card-content>
        <p *ngIf="isManufacturer">
          <ion-icon name="checkmark-circle" color="success"></ion-icon>
          You're connected as a <strong>Manufacturer</strong>. You can view
          <ion-badge color="success">all data</ion-badge> and add new
          manufacturer data.
        </p>
        <p *ngIf="!isManufacturer">
          <ion-icon name="information-circle" color="warning"></ion-icon>
          You're connected as a <strong>Customer</strong>. You can view
          <ion-badge color="primary">public data only</ion-badge>.
        </p>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Manufacturer data list section (only visible when wallet is connected) -->
  <div *ngIf="isWalletConnected">
    <ion-card>
      <ion-card-header>
        <ion-card-title>
          <ion-text *ngIf="isManufacturer" color="success"
            >Complete Manufacturer Data</ion-text
          >
          <ion-text *ngIf="!isManufacturer" color="primary"
            >Public Manufacturer Data</ion-text
          >
        </ion-card-title>
        <ion-card-subtitle>
          <ion-text *ngIf="isManufacturer"
            >Includes private manufacturing information</ion-text
          >
          <ion-text *ngIf="!isManufacturer">Public information only</ion-text>
        </ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <ion-list>
          <ion-item *ngIf="manufacturerData.length === 0">
            <ion-label class="ion-text-center">
              No manufacturer data found. {{isManufacturer ? 'Add one using the
              + button.' : ''}}
            </ion-label>
          </ion-item>
          <ion-item
            *ngFor="let data of manufacturerData"
            button
            (click)="clickShowDetail(data)"
            detail
            class="ion-text-wrap"
          >
            <ion-label>
              <h2>Product: {{data.name}}</h2>
              <p>ID: {{data.id}}</p>
              <p *ngIf="data.shipmentId">
                Linked Shipment: {{data.shipmentId}}
              </p>
              <p *ngIf="!data.shipmentId">No Shipment Linked</p>
            </ion-label>
          </ion-item>
        </ion-list>
      </ion-card-content>
    </ion-card>

    <ion-fab
      vertical="bottom"
      horizontal="end"
      slot="fixed"
      *ngIf="isWalletConnected && isManufacturer"
    >
      <ion-fab-button>
        <ion-icon (click)="clickAddNew()" name="add"> </ion-icon>
      </ion-fab-button>
    </ion-fab>
  </div>
</ion-content>
